<!DOCTYPE html><html><head><title>KeyGen2 - Credential Enrollment and Management Protocol</title><meta http-equiv=Content-Type content="text/html; charset=utf-8"><style type="text/css">
.tftable {border-collapse: collapse}
.tftable th {font-size:10pt;background: linear-gradient(to bottom, #eaeaea 14%,#fcfcfc 52%,#e5e5e5 89%);border-width:1px;padding:4pt 10pt 4pt 10pt;border-style:solid;border-color: #a9a9a9;text-align:center;font-family:arial,verdana,helvetica}
.tftable tr {background-color:#FFFFE0}
.tftable td {font-size:10pt;border-width:1px;padding:4pt 8pt 4pt 8pt;border-style:solid;border-color:#a9a9a9;font-family:arial,verdana,helvetica}
div {font-size:10pt;padding:10pt 0pt 0pt 0pt;font-family:arial,verdana,helvetica}
a {color:blue;font-family:verdana,helvetica;text-decoration:none}
.kg2box {padding:20pt;font-size:14pt;text-align:center;background: radial-gradient(ellipse at center, rgba(255,255,255,1) 0%,rgba(242,243,252,1) 38%,rgba(196,210,242,1) 100%);border-radius:8pt;border-width:1px;border-style:solid;border-color:#B0B0B0;box-shadow:3pt 3pt 3pt #D0D0D0}.dlgbtn {border-radius:3pt;border-color:grey;border-style:solid;border-width:2pt;background-color:lightgrey;padding:2pt 4pt 2pt 4pt;margin-bottom:2pt;display:inline-block}
.dlgtext {border-color:black;border-style:solid;border-width:1pt;padding:2pt 4pt 2pt 4pt;font-weight:bold;font-family:"Courier New",courier,helvetica}
.dlgtbl {padding:0px;margin-top:10pt;margin-bottom:10pt;margin-left:auto;margin-right:auto;border-color:grey;border-style:solid;border-width:1pt;border-spacing:0px;box-shadow:3pt 3pt 3pt #D0D0D0}
.dlgtbl td {background-color:white;border-width:0px}
</style></head><body style="margin:15pt"><div style="position:absolute;top:5pt;left:15pt;z-index:5;visibility:visible"><a href="http://webpki.org" title="WebPKI.org"><img src="data:image/gif;base64,R0lGODlhggBBANUAAAAAAP///+0bI+4pMe84P/BGTPJUWvNjaPRxdvV/hPaNkfebnviprPm3uvrGyP3i4/zU1nBxtMvL5NjY6uXl8fLy+C4wkjs9mUhKoFVXp2JkrX1+u4qLwpeYyaOkz7Cx1r2+3f7x8e7u7t3d3czMzLu7u6qqqpmZmYiIiHd3d2ZmZlVVVURERDMzMyIiIhEREQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAggBBAAAG/8CAcEgsGo/IpHLJbDqf0Kh0Sq1ar9isdsvter/gsHhMLpvP6LR6zW673/C4fE6v2+/hT2eSpFSSIB0SURIWGlAPCoqLCgwOSA4Kj0cLCgtEDAoPXR4WG0kbHkkZFnxQhYdPDgKsra0DCkYKArFFIQUCAxBEBgKTWxMWGEgVFxlIFBYXUqhQqwSMCgm4AghFs7VDtwIFm7y+XhcWFEcfFqXlFhHMhs4CBkcOAwIMRNhE2wUhRr2/WxsWRBkh5elIBAsf2KVysgoepXf2aA2BgEvfkX5ezK0rEkzchT9FxJEzIkGCKZLthkwomaQhkhCsItaCMO/AvovguiRbVgTgBv8MCDlaOEakwgZx5y50ADmkWYUOSM9FGEnEJZKYQ+7RrKYEoxdSg4YUK9WJ6JAOFjgQmYA0gwaCGU4GQFUB7ttzQatCPAJBAAGZ8rh2zdmFQ1oi5o5VOCcXrFigGqhSAJiBaaEMpKYOoXDQAgi9DvkJFjKLmrUlXrtcJkIqYQCAaoUstkDE8Ccj5mLPxeu6pzKmVrU16DXAG+lW9Zik7nIO5E6QhXgGAKFu828kGj4KKVQd+2Ehq1yJJ7Arot+bqAl3OejaNhGgrgEKDNCpA6C83OUWiT4kvPgCBzCAXlatWJSeP1x0cps4cnWSClBU+dTBhBRW+F0hwyghEnh7NTH/yzTcDIgTglvsFEBiRSQzTjAZCqEBXjDGmFIzSrwYVnBMYJOPiEUs1wVQE7zY2xAHcaAgES9WqCSFrtGYhI0chpajRDsm4SMXsF1XBHUXvPgZkRYwtQR/Go4T5RP3BFDliGFQd85tRgDVHBGdfMlEfkmQGQCOS6SpZkVIXLnFbBaEZQRaKVm3UBF19cbdRke8qBufSvj552jfkMgFKS0aoaJ9vg05BECQchfQEZ1od6YTll56WqZioDVfpOgwKs5STb14AVWXAaWZEJydY+eeHU6ZzRAPzPOqEIICE6YSH0jHEVIaaCDnBXKhMoGcbhF0gaiUJtGqEFst2+wWuiWR/26KAOF1wQZi7nZIBRxE5QlV/RXbp0R8KTvEuXSUZCgTKw2Mx8EIJ6zwwgw37PDDEEcscRsAVGzxxRhnrPHGHHfs8ccghzzxyCSXbPLJKKesMhgjoIBCCimMAIYJLrssAhknuKwCCjKrQUIKNwdAggskgAGAzCi4IIYILBQtRAknrNFC0EKcsILRQ7wghgomFNEzGiSwUIQIAGAdAApRh6F1GiRQ/bTYRZT9BQAkvPC12WgAgILXALg9wtVznw14GC2UMAQJKgwORttG7EwECk57IfcKe4dhwtRDuLwG0yqUUAIKhn9hAgBdi+BC12GgwMIJUK+Q9hojlBD5yZ7fvRTy7bjnrvvuvPfu++/ABy/88EQEAQA7" style="border-width:1px;border-style:solid;border-color:blue;box-shadow:3pt 3pt 3pt #D0D0D0" alt="WebPKI.org logo..."></a></div><div style="width:1000pt"><div style="margin-top:200pt;margin-bottom:200pt;text-align:center"><span style="font-size:28pt;font-family:'Times New Roman',Times,Serif">KeyGen2</span><br><span style="font-size:14pt">&nbsp;<br>Credential Provisioning and Management Protocol</span></div></div><div style="width:1000pt"><table style="border-width:1px;padding:4pt 10pt 4pt 10pt;border-style:solid;border-color: #808080;margin-left:auto;margin-right:auto;box-shadow:3pt 3pt 3pt #D0D0D0;margin-bottom:20pt"><tr><td><i>Disclaimer</i>: This is a system in development. That is, the specification may change without notice.</td></tr></table></div><div><span style="font-size:14pt;font-family:arial,verdana,helvetica">Table of Contents</span><table style="margin-left:20pt;margin-top:5pt"><tr style="white-space: nowrap"><td style="text-align:right"><a href="#Introduction">1.&nbsp;</a></td><td colspan="3"><a href="#Introduction">Introduction</a></td></tr><tr style="white-space: nowrap"><td style="text-align:right"><a href="#Proxy_Scheme">2.&nbsp;</a></td><td colspan="3"><a href="#Proxy_Scheme">Proxy Scheme</a></td></tr><tr style="white-space: nowrap"><td style="text-align:right"><a href="#Protocol_Description">3.&nbsp;</a></td><td colspan="3"><a href="#Protocol_Description">Protocol Description</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td style="text-align:right"><a href="#Invocation">3.1.&nbsp;</a></td><td colspan="1"><a href="#Invocation">Invocation</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td style="text-align:right"><a href="#HTTP_Dependencies">3.2.&nbsp;</a></td><td colspan="1"><a href="#HTTP_Dependencies">HTTP Dependencies</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td style="text-align:right"><a href="#Error_Handling">3.3.&nbsp;</a></td><td colspan="1"><a href="#Error_Handling">Error Handling</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td style="text-align:right"><a href="#Key_Management_Operations">3.4.&nbsp;</a></td><td colspan="1"><a href="#Key_Management_Operations">Key Management Operations</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td style="text-align:right"><a href="#Termination_Message">3.5.&nbsp;</a></td><td colspan="1"><a href="#Termination_Message">Termination Message</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td style="text-align:right"><a href="#Deferred_Issuance">3.6.&nbsp;</a></td><td colspan="1"><a href="#Deferred_Issuance">Deferred Issuance</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td style="text-align:right"><a href="#SOP_Adherance">3.7.&nbsp;</a></td><td colspan="1"><a href="#SOP_Adherance">SOP Adherance</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td style="text-align:right"><a href="#JCS_Profile">3.8.&nbsp;</a></td><td colspan="1"><a href="#JCS_Profile">JCS Profile</a></td></tr><tr style="white-space: nowrap"><td style="text-align:right"><a href="#Notation">4.&nbsp;</a></td><td colspan="3"><a href="#Notation">Notation</a></td></tr><tr style="white-space: nowrap"><td style="text-align:right"><a href="#Data_Types">5.&nbsp;</a></td><td colspan="3"><a href="#Data_Types">Data Types</a></td></tr><tr style="white-space: nowrap"><td style="text-align:right"><a href="#Objects">6.&nbsp;</a></td><td colspan="3"><a href="#Objects">Objects</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#InvocationRequest">InvocationRequest</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#InvocationResponse">InvocationResponse</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#ProvisioningInitializationRequest">ProvisioningInitializationRequest</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#ProvisioningInitializationResponse">ProvisioningInitializationResponse</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#CredentialDiscoveryRequest">CredentialDiscoveryRequest</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#CredentialDiscoveryResponse">CredentialDiscoveryResponse</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#KeyCreationRequest">KeyCreationRequest</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#KeyCreationResponse">KeyCreationResponse</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#ProvisioningFinalizationRequest">ProvisioningFinalizationRequest</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#ProvisioningFinalizationResponse">ProvisioningFinalizationResponse</a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#keyManagementKey"><i>keyManagementKey</i></a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#updatableKeyManagementKeys"><i>updatableKeyManagementKeys</i></a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#virtualEnvironment"><i>virtualEnvironment</i></a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#lookupSpecifiers"><i>lookupSpecifiers</i></a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#searchFilter"><i>searchFilter</i></a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#lookupResults"><i>lookupResults</i></a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#matchingCredentials"><i>matchingCredentials</i></a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#pukPolicySpecifiers"><i>pukPolicySpecifiers</i></a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#pinPolicySpecifiers"><i>pinPolicySpecifiers</i></a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#keyEntrySpecifiers"><i>keyEntrySpecifiers</i></a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#generatedKeys"><i>generatedKeys</i></a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#issuedCredentials"><i>issuedCredentials</i></a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#cloneKeyProtection"><i>cloneKeyProtection</i></a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#deleteKeys"><i>deleteKeys</i></a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#unlockKeys"><i>unlockKeys</i></a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#updateKey"><i>updateKey</i></a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#encryptedExtensions"><i>encryptedExtensions</i></a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#extensions"><i>extensions</i></a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#logotypes"><i>logotypes</i></a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#propertyBags"><i>propertyBags</i></a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#properties"><i>properties</i></a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#importPrivateKey"><i>importPrivateKey</i></a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#importSymmetricKey"><i>importSymmetricKey</i></a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#clientCapabilities"><i>clientCapabilities</i></a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#imageAttributes"><i>imageAttributes</i></a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#deviceId"><i>deviceId</i></a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#serverEphemeralKey"><i>serverEphemeralKey</i></a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#clientEphemeralKey"><i>clientEphemeralKey</i></a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#signature"><i>signature</i></a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#publicKey"><i>publicKey</i></a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#publicKey_EC"><i>publicKey EC</i></a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#publicKey_RSA"><i>publicKey RSA</i></a></td></tr><tr style="white-space: nowrap"><td></td><td style="width:15pt"></td><td colspan="2"><a href="#signerCertificate"><i>signerCertificate</i></a></td></tr></table><table style="margin-left:20pt;margin-top:5pt"><tr style="white-space: nowrap"><td style="text-align:right"><a href="#Sample_Run">Appendix A:&nbsp;</a></td><td colspan="1"><a href="#Sample_Run">Sample Run</a></td></tr><tr style="white-space: nowrap"><td style="text-align:right"><a href="#Acknowledgements">Appendix B:&nbsp;</a></td><td colspan="1"><a href="#Acknowledgements">Acknowledgements</a></td></tr><tr style="white-space: nowrap"><td style="text-align:right"><a href="#References">Appendix C:&nbsp;</a></td><td colspan="1"><a href="#References">References</a></td></tr><tr style="white-space: nowrap"><td style="text-align:right"><a href="#Document_History">Appendix D:&nbsp;</a></td><td colspan="1"><a href="#Document_History">Document History</a></td></tr><tr style="white-space: nowrap"><td style="text-align:right"><a href="#Author">Appendix E:&nbsp;</a></td><td colspan="1"><a href="#Author">Author</a></td></tr></table></div><div style="width:1000pt"><div style="padding:10pt 0pt 10pt 0pt" id="Introduction"><span style="font-size:14pt">1.&nbsp;Introduction</span></div>KeyGen2 is a web-based protocol for enrolling and managing credentials like X.509 certificates <a href="#Reference.RFC5280">[RFC5280]</a>. The protocol is a part of a security architecture which at the core consists of SKS (Secure Key Store) <a href="#Reference.SKS">[SKS]</a>.<div style="height:6pt;padding:0px"></div> The KeyGen2 protocol is expressed as a set of JSON <a href="#Reference.RFC7159">[RFC7159]</a> objects. This document contains a description of these objects and how they interact, while the integration with the SKS API is dealt with in the SKS architecture document <a href="#Reference.SKS">[SKS]</a>.<div style="height:6pt;padding:0px"></div>Parts of the protocol rely on cryptographic constructs using JSON which initially were created for the KeyGen2 project, but later became an activity of its own: JSON Cleartext Signature <a href="#Reference.JCS">[JCS]</a>.<div style="height:6pt;padding:0px"></div>Finding the proper balance in a complex scheme like KeyGen2 is a combination of &quot;gut feeling&quot;, political considerations, available technology, foresight and market research. If this particular specification hit the right level only time can tell.<table style="margin-top:20pt;margin-bottom:20pt;margin-left:auto;margin-right:auto;text-align:center"><tr><td>&quot;<i>Perfection&nbsp;is&nbsp;achieved,&nbsp;not&nbsp;when&nbsp;there&nbsp;is&nbsp;nothing&nbsp;more<br>to&nbsp;add,&nbsp;but&nbsp;when&nbsp;there&nbsp;is&nbsp;nothing&nbsp;left&nbsp;to&nbsp;take&nbsp;away</i>&quot;</td></tr><tr><td style="padding-top:4pt;font-size:8pt;text-align:right">Antoine de Saint-Exupéry</td></tr></table></div><div style="width:1000pt"><div style="padding:10pt 0pt 10pt 0pt" id="Proxy_Scheme"><span style="font-size:14pt">2.&nbsp;Proxy Scheme</span></div>Unlike certificate management protocols like CMP <a href="#Reference.RFC4210">[RFC4210]</a>, <i>KeyGen2 mandates a two-layer client architecture</i> where the outermost part is talking to the outside world (user and issuer), while an inner part does the communication with the SKS. That is, the client implementation acts as &quot;proxy&quot; enabling the use of a cleartext, JSON-based, fairly high-level protocol with issuer, in spite of the fact that SKS only deals with low-level binary data.<div style="height:6pt;padding:0px"></div>Another core proxy task is minimizing network roundtrips through SKS command aggregation.<div style="height:6pt;padding:0px"></div>Although KeyGen2 depends on a proxy for doing the &quot;Heavy Lifting&quot;, E2ES (End To End Security) is achieved through the use of a <i>dynamically created shared secret</i>, which is only known by the SKS and the issuer. <div style="height:6pt;padding:0px"></div>For a detailed description of the proxy scheme and the E2ES solution, consult the SKS architecture document <a href="#Reference.SKS">[SKS]</a>.</div><div style="width:1000pt"><div style="padding:10pt 0pt 10pt 0pt" id="Protocol_Description"><span style="font-size:14pt">3.&nbsp;Protocol Description</span></div>This chapter contains a high-level description of the KeyGen2 protocol while the subsequent chapters cover the actual format. <div style="height:6pt;padding:0px"></div>To facilitate a straightforward implementation as well as robust operation, KeyGen2 builds on a concept where each major process step is handled by a specific request/response pair as outlined below:<table style="width:600pt;margin-top:10pt;margin-left:auto;margin-right:auto;border-collapse:collapse"><tr><td style="padding:0px"><div style="margin-left:auto;margin-right:auto;height:10pt;width:2pt;background-color:#909090"></div></td><td></td></tr><tr><td style="padding:0px"><div class="kg2box">Invocation</div></td><td style="padding-left:20pt">Protocol invocation. During this step the user should be alerted by a browser-defined dialog telling what is supposed to happen giving as well as providing an option aborting the process. In addition, the issuer <i>may</i> perform a client platform capability query.</td></tr><tr><td style="padding:0px"><div style="margin-left:auto;margin-right:auto;height:14pt;width:2pt;background-color:#909090"></div></td><td></td></tr><tr><td style="padding:0px"><div class="kg2box">ProvisioningInitialization</div></td><td style="padding-left:20pt">Creation of a <i>shared session key</i> securing the rest of the interactions between the issuer and the SKS. To support future updates of provisioned credentials, the issuer <i>may</i> also provide a <a href="#ProvisioningInitializationRequest.keyManagementKey">keyManagementKey</a>.</td></tr><tr><td style="padding:0px"><div style="margin-left:auto;margin-right:auto;height:14pt;width:2pt;background-color:#909090"></div></td><td></td></tr><tr><td style="padding:0px"><div class="kg2box">CredentialDiscovery</div></td><td style="padding-left:20pt"><i>Optional</i>: Issuer lookup of already provisioned SKS credentials. This is primarily used when keys need to be updated or unlocked.</td></tr><tr><td style="padding:0px"><div style="margin-left:auto;margin-right:auto;height:14pt;width:2pt;background-color:#909090"></div></td><td></td></tr><tr><td style="padding:0px"><div class="kg2box">KeyCreation</div></td><td style="padding-left:20pt">Creation of asymmetric key-pairs in the SKS. If user-defined PINs are to be set, this is carried out during <a href="#KeyCreationRequest">KeyCreationRequest</a>. After key-pairs have been created the public keys are sent to the issuer for certification.</td></tr><tr><td style="padding:0px"><div style="margin-left:auto;margin-right:auto;height:14pt;width:2pt;background-color:#909090"></div></td><td></td></tr><tr><td style="padding:0px"><div class="kg2box">ProvisioningFinalization</div></td><td style="padding-left:20pt">Deployment of credentials and associated attributes as well as key management operations are performed in this step. Finally the session is terminated. If the operation is <i>successful</i>, a cryptographic proof is returned to the issuer.</td></tr><tr><td style="padding:0px"><div style="margin-left:auto;margin-right:auto;height:6pt;width:2pt;background-color:#909090"></div></td><td></td></tr><tr><td style="padding:0px"><div style="margin-left:auto;margin-right:auto;width:0pt;height:0px;border-style: solid;border-width: 8pt 4pt 0pt 4pt;border-color:#909090 transparent transparent transparent"></div></td><td></td></tr></table>The result of the <a href="#ProvisioningFinalizationResponse">ProvisioningFinalizationResponse</a> is anticipated to be a custom <a href="#Termination_Message">Termination&nbsp;Message</a>, typically telling the user that the operation succeeded.</div><div style="width:1000pt"><div style="padding:10pt 0pt 10pt 0pt" id="Invocation"><span style="font-size:14pt">3.1.&nbsp;Invocation</span></div>Invocation of KeyGen2 relies on a generic browser extension interface according to the following Web&nbsp;IDL <a href="#Reference.WEBIDL">[WEBIDL]</a> definition:<div style="padding:10pt 0pt 15pt 20pt"><code>interface WebPKI {<br></code><code style="color:#A0A0A0">&nbsp;&nbsp;// Verify if named JSON object is supported</code><code><br>&nbsp;&nbsp;boolean isSupported(DOMString context, DOMString qualifier);<br>&nbsp;<br></code><code style="color:#A0A0A0">&nbsp;&nbsp;// Invoke with full JSON object given as a string. Returns false if object is not supported</code><code><br>&nbsp;&nbsp;boolean invoke(DOMString invocationObject);<br>};<br>&nbsp;<br>partial interface Window {<br></code><code style="color:#A0A0A0">&nbsp;&nbsp;// This interface extends the &quot;window&quot; object</code><code><br>&nbsp;&nbsp;readonly attribute WebPKI webpki;<br>};</code></div>The JavaScript (presumably embedded in an HTML page) below shows how to use the interface:<div style="padding:10pt 0pt 15pt 20pt"><code>if (!window.webpki.invoke('{&quot;</code><code style="color:#606060">@context</code><code>&quot;:&quot;</code><code style="color:#0000C0">http://xmlns.webpki.org/keygen2/beta/20150112</code><code>&quot;,' +<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&quot;</code><code style="color:#606060">@qualifier</code><code>&quot;:&quot;</code><code style="color:#0000C0">InvocationRequest</code><code>&quot;,' +<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'</code><i>Other properties associated with the request object</i><code>}') {<br>&nbsp;&nbsp;alert('Not supported');<br>};</code></div>Note that properties do not have to be ordered and that whitespace between elements is ignored.</div><div style="width:1000pt"><div style="padding:10pt 0pt 10pt 0pt" id="HTTP_Dependencies"><span style="font-size:14pt">3.2.&nbsp;HTTP Dependencies</span></div>KeyGen2 objects transferred through HTTP <b>must</b> use the Content-Type <code>application/json;&nbsp;charset=utf-8</code>.<div style="height:6pt;padding:0px"></div>Since KeyGen2 is to be regarded as an intrinsic part of the browser, HTTP cookies <b>must</b> be handled as for other HTTP requests.</div><div style="width:1000pt"><div style="padding:10pt 0pt 10pt 0pt" id="Error_Handling"><span style="font-size:14pt">3.3.&nbsp;Error Handling</span></div>Errors occurring on the <i>client's side</i> <b>must</b> terminate the session and display an error dialog telling the user what happened.<div style="height:6pt;padding:0px"></div><i>Server-side</i> errors <b>must</b> abort the current server operation and return an appropriate <a href="#Termination_Message">Termination&nbsp;Message</a> to the user. If the KeyGen2 proxy at this stage is rather expecting a KeyGen2 protocol object (see <a href="#HTTP_Dependencies">HTTP&nbsp;Dependencies</a>), the client session <b>must</b> be terminated.<div style="height:6pt;padding:0px"></div>Whenever a KeyGen2 client session is aborted, the proxy <i>should</i> also abort the associated, potentially active SKS provisioning session (see <code>abortProvisioningSession</code>).</div><div style="width:1000pt"><div style="padding:10pt 0pt 10pt 0pt" id="Key_Management_Operations"><span style="font-size:14pt">3.4.&nbsp;Key Management Operations</span></div>KeyGen2 provides built-in support for the SKS key-management operations <code>postUnlockKey</code>, <code>postDeleteKey</code>, <code>postUpdateKey</code> and <code>postCloneKeyProtection</code>.<div style="height:6pt;padding:0px"></div>In the case the exact key is not known in advance, you <b>must</b> include a key discovery sequence as described in <a href="#Reference.SKS">[SKS]</a> <i>Appendix D, Remote Key Lookup</i>.</div><div style="width:1000pt"><div style="padding:10pt 0pt 10pt 0pt" id="Termination_Message"><span style="font-size:14pt">3.5.&nbsp;Termination Message</span></div>When a KeyGen2 protocol sequence terminates (like when the proxy has sent a <a href="#ProvisioningFinalizationResponse">ProvisioningFinalizationResponse</a> object to the server), the browser <b>must</b> return to its &quot;normal&quot; state, ready for receiving a matching HTTP body containing a HTML page or similar.<div style="height:6pt;padding:0px"></div>Note that returned data <b>must</b> target the same <code>window</code> object which was used during invocation.</div><div style="width:1000pt"><div style="padding:10pt 0pt 10pt 0pt" id="Deferred_Issuance"><span style="font-size:14pt">3.6.&nbsp;Deferred Issuance</span></div>To reduce costs for credential issuers, they may require users' filling in forms on the web with user-related information followed by a KeyGen2 sequence terminating (see <a href="#Termination_Message">Termination&nbsp;Message</a>) after <a href="#KeyCreationResponse">KeyCreationResponse</a>. This mode <b>must</b> be indicated by setting <a href="#KeyCreationRequest.deferredIssuance">deferredIssuance</a> to <code>true</code>.<div style="height:6pt;padding:0px"></div>After the issuer in some way have verified the user's claimed data (and typically also the SKS <code>Device&nbsp;ID</code>), the certification process is <i>resumed</i> by relaunching the <a href="#InvocationRequest">InvocationRequest</a> (with <a href="#InvocationRequest.action">action</a> set to <code>resume</code>) through a URL sent to the user via mail, SMS, QR-code or NFC. The KeyGen2 proxy <b>must</b> after reception of the <a href="#InvocationRequest">InvocationRequest</a> verify that there actually is an <i>open</i> SKS provisioning session having a matching <a href="#InvocationRequest.serverSessionId">serverSessionId</a>.</div><div style="width:1000pt"><div style="padding:10pt 0pt 10pt 0pt" id="SOP_Adherance"><span style="font-size:14pt">3.7.&nbsp;SOP Adherance</span></div>The KeyGen2 proxy <b>must not</b> accept <code>SubmitURL</code> requests outside of the domain which returned the <a href="#InvocationRequest">InvocationRequest</a> message, i.e. strictly following SOP (Same Origin Policy).</div><div style="width:1000pt"><div style="padding:10pt 0pt 10pt 0pt" id="JCS_Profile"><span style="font-size:14pt">3.8.&nbsp;JCS Profile</span></div>Although KeyGen2 makes extensive use of the JSON Cleartext Signature scheme <a href="#Reference.JCS">[JCS]</a> a compliant implementation <b>must not</b> accept JOSE <a href="#Reference.JOSE">[JOSE]</a> algorithm identifiers since these are not natively supported by the target. See <a href="#Reference.SKS">[SKS]</a> <i>Algorithm Support</i>.<div style="height:6pt;padding:0px"></div>In addition, the JCS <code>keyId</code>, <code>extensions</code> and <code>pemUrl</code> properties <b>must not</b> be featured in KeyGen2 messages either.<div style="height:6pt;padding:0px"></div>This document only refers to the required JCS properties.</div><div style="width:1000pt"><div style="padding:10pt 0pt 10pt 0pt" id="Notation"><span style="font-size:14pt">4.&nbsp;Notation</span></div>JSON objects are described as tables with associated properties. When a property holds a JSON object this is denoted by a <a href="#Notation">link</a> to the actual definition. <div style="height:6pt;padding:0px"></div>Properties may either be <i>mandatory</i> (M) or <i>optional</i> (O) as defined in the &quot;Req&quot; column.<div style="height:6pt;padding:0px"></div>Array properties are identified by [&thinsp;]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;x-y</span> where the range expression represents the valid number of array elements. <div style="height:6pt;padding:0px"></div>In some JSON objects there is a choice from a set of <i>mutually exclusive</i> alternatives.<br>This is manifested in object tables like the following:<table class="tftable" style="font-style:italic;margin-top:10pt;margin-bottom:5pt"><tr><td>Property selection 1</td><td>Type selection 1</td><td rowspan="2">Req</td><td>Comment selection 1</td></tr><tr><td>Property selection 2</td><td>Type selection 2</td><td>Comment selection 2</td></tr></table></div><div style="width:1000pt"><div style="padding:10pt 0pt 10pt 0pt" id="Data_Types"><span style="font-size:14pt">5.&nbsp;Data Types</span></div>The table below shows how the data types used by this specification are mapped into native JSON types:</div><table class="tftable" style="margin-top:10pt"><tr><th>Type</th><th>Mapping</th><th>Description</th></tr><tr id="Datatype.bool"><td style="text-align:center">bool</td><td style="text-align:center"><code>true</code> or <code>false</code></td><td>Boolean</td></tr><tr id="Datatype.ushort"><td style="text-align:center">ushort</td><td style="text-align:center"><i>number</i></td><td>Unsigned two-byte integer</td></tr><tr id="Datatype.uint"><td style="text-align:center">uint</td><td style="text-align:center"><i>number</i></td><td>Unsigned four-byte integer</td></tr><tr id="Datatype.bigint"><td style="text-align:center">bigint</td><td style="text-align:center"><i>string</i></td><td>Base10-encoded integer with arbitrary precision</td></tr><tr id="Datatype.string"><td style="text-align:center">string</td><td style="text-align:center"><i>string</i></td><td>Arbitrary string</td></tr><tr id="Datatype.uri"><td style="text-align:center">uri</td><td style="text-align:center"><i>string</i></td><td>URI <a href="#Reference.RFC3986">[RFC3986]</a></td></tr><tr id="Datatype.id"><td style="text-align:center">id</td><td style="text-align:center"><i>string</i></td><td>Identifier which <b>must</b> consist of 1-32 characters, where each character is in the range <code>'!'</code> - <code>'~'</code> (0x21 - 0x7e).</td></tr><tr id="Datatype.base64"><td style="text-align:center">base64</td><td style="text-align:center"><i>string</i></td><td>Base64URL-encoded <a href="#Reference.RFC4648">[RFC4648]</a> binary data</td></tr><tr id="Datatype.crypto"><td style="text-align:center">crypto</td><td style="text-align:center"><i>string</i></td><td>Base64URL-encoded positive integer with arbitrary precision. Note that leading zero-valued bytes <b>must</b> be discarded</td></tr><tr id="Datatype.date"><td style="text-align:center">date</td><td style="text-align:center"><i>string</i></td><td>ISO date-time <code>YYYY-MM-DDThh:mm:ss{timezone}</code>.</td></tr><tr id="Datatype.object"><td style="text-align:center">object</td><td style="text-align:center"><code>{}</code></td><td>JSON object</td></tr></table><div>Note that &quot;Type&quot; refers to the element type for arrays.<div style="height:6pt;padding:0px"></div></div><div style="width:1000pt"><div style="padding:10pt 0pt 10pt 0pt" id="Objects"><span style="font-size:14pt">6.&nbsp;Objects</span></div>The following tables describe the KeyGen2 JSON structures in detail.<div style="height:6pt;padding:0px"></div>Entries written in <i>italics</i> like <a href="#generatedKeys"><i>generatedKeys</i></a> represent sub objects, while the other entries such as <a href="#InvocationRequest">InvocationRequest</a> consitute of the actual messages.</div><table class="tftable" style="width:1000pt"><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="InvocationRequest">InvocationRequest</span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="InvocationRequest.context"><code>&quot;<span style="color:#606060">@context</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">http://xmlns.webpki.org/keygen2/beta/20150112</span>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">M</td><td>KeyGen2 name space/version indicator.</td></tr><tr><td style="white-space:nowrap" id="InvocationRequest.qualifier"><code>&quot;<span style="color:#606060">@qualifier</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">InvocationRequest</span>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">M</td><td>Actual KeyGen2 message type.</td></tr><tr><td style="white-space:nowrap" id="InvocationRequest.serverSessionId"><code>&quot;<span style="color:#C00000">serverSessionId</span>&quot;:&nbsp;</code><code>&quot;</code><i>serverSessionId</i><code>&quot;</code></td><td style="text-align:center">id</td><td style="text-align:center">M</td><td>The <code>serverSessionId</code> <b>must</b> remain constant for the entire session.</td></tr><tr><td style="white-space:nowrap" id="InvocationRequest.submitUrl"><code>&quot;<span style="color:#C00000">submitUrl</span>&quot;:&nbsp;</code><code>&quot;</code><i>submitUrl</i><code>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">M</td><td>Where to POST the response.</td></tr><tr><td style="white-space:nowrap" id="InvocationRequest.action"><code>&quot;<span style="color:#C00000">action</span>&quot;:&nbsp;</code><code>&quot;</code><i>action</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">M</td><td>The <code>action</code> property gives (through a suitable GUI dialog) the user a hint of what the session in progress is about to perform. The valid constants are:<ul><li><code>manage</code> - Create, delete and/or update credentials</li><li style="padding-bottom:4pt;padding-top:4pt"><code>resume</code> - Resume operation after an interrupted <a href="#KeyCreationResponse">KeyCreationResponse</a>.  See <a href="#Deferred_Issuance">Deferred&nbsp;Issuance</a>. A confirming client <b>must</b> after responding with <a href="#InvocationResponse">InvocationResponse</a> only accept a <a href="#ProvisioningFinalizationRequest">ProvisioningFinalizationRequest</a></li><li><code>unlock</code> - Unlock existing keys. A conforming client should disallow <a href="#KeyCreationRequest">KeyCreationRequest</a></li></ul></td></tr><tr><td style="white-space:nowrap" id="InvocationRequest.abortUrl"><code>&quot;<span style="color:#C00000">abortUrl</span>&quot;:&nbsp;</code><code>&quot;</code><i>abortUrl</i><code>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">O</td><td>Optional URL the provisioning client should launch the browser with if the user cancels the process.</td></tr><tr><td style="white-space:nowrap" id="InvocationRequest.privacyEnabled"><code>&quot;<span style="color:#C00000">privacyEnabled</span>&quot;:&nbsp;</code><code>&quot;</code><i>privacyEnabled</i><code>&quot;</code></td><td style="text-align:center">bool</td><td style="text-align:center">O</td><td>The <code>privacyEnabled</code> flag is used to set mode during <a href="#ProvisioningInitializationRequest">ProvisioningInitializationRequest</a>.<br>See <code>SKS:createProvisioningSession.privacyEnabled</code>.<div style="height:6pt;padding:0px"></div>Note: The default value is <code>false</code>.</td></tr><tr><td style="white-space:nowrap" id="InvocationRequest.preferredLanguages"><code>&quot;<span style="color:#C00000">preferredLanguages</span>&quot;:&nbsp;</code>[<code>&quot;</code><i>preferredLanguages</i><code>&quot;</code>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">string</td><td style="text-align:center">O</td><td><i>Optional</i>: List of preferred languages using ISO 639-1 two-character notation.</td></tr><tr><td style="white-space:nowrap" id="InvocationRequest.targetKeyContainers"><code>&quot;<span style="color:#C00000">targetKeyContainers</span>&quot;:&nbsp;</code>[<code>&quot;</code><i>targetKeyContainers</i><code>&quot;</code>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">string</td><td style="text-align:center">O</td><td><i>Optional</i>: List of target key container types.  The elements may be:<ul><li><code>software</code> - Software protected key container</li><li style="padding-top:4pt"><code>embedded</code> - Hardware protected embedded key container</li><li style="padding-top:4pt"><code>uicc</code> - UICC/SIM card</li><li style="padding-top:4pt"><code>sdcard</code> - SD card</li><li style="padding-top:4pt"><code>external</code> - External/connected key container</li></ul>The key containers are listed in preference order. If no matching container is available the client may prompt the user for inserting a card or similar.<div style="height:6pt;padding:0px"></div>If <code>targetKeyContainers</code> is undefined the provisioning client is supposed to use the system's 'native' keystore.</td></tr><tr><td style="white-space:nowrap" id="InvocationRequest.clientCapabilityQuery"><code>&quot;<span style="color:#C00000">clientCapabilityQuery</span>&quot;:&nbsp;</code>[<code>&quot;</code><i>List of URIs</i><code>&quot;</code>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">uri</td><td style="text-align:center">O</td><td><i>Optional</i>: List of URIs signifying client (platform) capabilities. The response (<a href="#InvocationResponse.clientCapabilities">clientCapabilities</a>) <b>must</b> contain the same URIs (in any order). <div style="height:6pt;padding:0px"></div>Note that capabilities may refer to algorithms or specific extensions (see <code>SKS:addExtension</code>), as well as to non-SKS items such as <a href="#ProvisioningInitializationRequest.virtualEnvironment">virtualEnvironment</a>.<div style="height:6pt;padding:0px"></div>Another possible use of this feature is for signaling support for extensions in the protocol itself while keeping the name-space etc. intact.<div style="height:6pt;padding:0px"></div><i>If requested capabilities are considered as privacy sensitive, a conforming implementation should ask for the user's permission to disclose them</i>.<div style="height:6pt;padding:0px"></div>Device-specific data like IMEI numbers <b>must not</b> be requested in the <a href="#InvocationRequest.privacyEnabled">privacyEnabled</a> mode.<div style="height:6pt;padding:0px"></div>For quering <a href="#clientCapabilities.values">values</a> the following client attribute URIs are pre-defined:<ul><li><code>http://xmlns.webpki.org/keygen2/clientattr#imei-number</code></li><li><code>http://xmlns.webpki.org/keygen2/clientattr#ip-address</code></li><li><code>http://xmlns.webpki.org/keygen2/clientattr#mac-address</code></li><li><code>http://xmlns.webpki.org/keygen2/clientattr#os-vendor</code></li><li><code>http://xmlns.webpki.org/keygen2/clientattr#os-version</code></li><li><code>http://xmlns.webpki.org/keygen2/clientattr#device-pin-support</code></li></ul></td></tr><tr><td style="white-space:nowrap" id="InvocationRequest.signature"><code>&quot;<span style="color:#C00000">signature</span>&quot;:&nbsp;</code><a href="#signature">signature</a></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td><i>Optional</i> X.509-based signature covering the request including the <code>certificatePath</code> property. See <a href="#signature">signature</a>.<div style="height:6pt;padding:0px"></div>It is <b>recommended</b> using a commercial grade TLS certificate to avoid user security alerts.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="InvocationResponse">InvocationResponse</span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="InvocationResponse.context"><code>&quot;<span style="color:#606060">@context</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">http://xmlns.webpki.org/keygen2/beta/20150112</span>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">M</td><td>KeyGen2 name space/version indicator.</td></tr><tr><td style="white-space:nowrap" id="InvocationResponse.qualifier"><code>&quot;<span style="color:#606060">@qualifier</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">InvocationResponse</span>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">M</td><td>Actual KeyGen2 message type.</td></tr><tr><td style="white-space:nowrap" id="InvocationResponse.serverSessionId"><code>&quot;<span style="color:#C00000">serverSessionId</span>&quot;:&nbsp;</code><code>&quot;</code><i>serverSessionId</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">M</td><td>Copy of <code>serverSessionId</code> from <a href="#InvocationRequest">InvocationRequest</a>.</td></tr><tr><td style="white-space:nowrap" id="InvocationResponse.nonce"><code>&quot;<span style="color:#C00000">nonce</span>&quot;:&nbsp;</code><code>&quot;</code><i>nonce</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">O</td><td><i>Optional</i> 1-32 byte nonce. See <a href="#ProvisioningInitializationRequest">ProvisioningInitializationRequest</a>.</td></tr><tr><td style="white-space:nowrap" id="InvocationResponse.clientCapabilities"><code>&quot;<span style="color:#C00000">clientCapabilities</span>&quot;:&nbsp;</code>[<a href="#clientCapabilities" style="margin-left:2pt;margin-right:2pt;">clientCapabilities</a>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td>List of capabilities including algorithms, specific features, dynamic or static data, and preferred image sizes.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="ProvisioningInitializationRequest">ProvisioningInitializationRequest</span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationRequest.context"><code>&quot;<span style="color:#606060">@context</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">http://xmlns.webpki.org/keygen2/beta/20150112</span>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">M</td><td>KeyGen2 name space/version indicator.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationRequest.qualifier"><code>&quot;<span style="color:#606060">@qualifier</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">ProvisioningInitializationRequest</span>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">M</td><td>Actual KeyGen2 message type.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationRequest.serverSessionId"><code>&quot;<span style="color:#C00000">serverSessionId</span>&quot;:&nbsp;</code><code>&quot;</code><i>serverSessionId</i><code>&quot;</code></td><td style="text-align:center">id</td><td style="text-align:center">M</td><td>See <code>SKS:createProvisioningSession.serverSessionId</code> and <a href="#InvocationRequest">InvocationRequest</a>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationRequest.submitUrl"><code>&quot;<span style="color:#C00000">submitUrl</span>&quot;:&nbsp;</code><code>&quot;</code><i>submitUrl</i><code>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">M</td><td>Where to POST the response.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationRequest.serverTime"><code>&quot;<span style="color:#C00000">serverTime</span>&quot;:&nbsp;</code><code>&quot;</code><i>serverTime</i><code>&quot;</code></td><td style="text-align:center">date</td><td style="text-align:center">M</td><td>Server time which the client should verify as a &quot;sanity&quot; check.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationRequest.sessionKeyAlgorithm"><code>&quot;<span style="color:#C00000">sessionKeyAlgorithm</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">http://xmlns.webpki.org/sks/algorithm#session.1</span>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">M</td><td>See <code>SKS:createProvisioningSession.sessionKeyAlgorithm</code>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationRequest.sessionKeyLimit"><code>&quot;<span style="color:#C00000">sessionKeyLimit</span>&quot;:&nbsp;</code><i>sessionKeyLimit</i></td><td style="text-align:center">ushort</td><td style="text-align:center">M</td><td>See <code>SKS:createProvisioningSession.sessionKeyLimit</code>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationRequest.sessionLifeTime"><code>&quot;<span style="color:#C00000">sessionLifeTime</span>&quot;:&nbsp;</code><i>sessionLifeTime</i></td><td style="text-align:center">uint</td><td style="text-align:center">M</td><td>See <code>SKS:createProvisioningSession.sessionLifeTime</code>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationRequest.serverEphemeralKey"><code>&quot;<span style="color:#C00000">serverEphemeralKey</span>&quot;:&nbsp;</code><a href="#serverEphemeralKey">serverEphemeralKey</a></td><td style="text-align:center">object</td><td style="text-align:center">M</td><td>See <code>SKS:createProvisioningSession.serverEphemeralKey</code>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationRequest.keyManagementKey"><code>&quot;<span style="color:#C00000">keyManagementKey</span>&quot;:&nbsp;</code><a href="#keyManagementKey">keyManagementKey</a></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td>See <code>SKS:createProvisioningSession.keyManagementKey</code>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationRequest.virtualEnvironment"><code>&quot;<span style="color:#C00000">virtualEnvironment</span>&quot;:&nbsp;</code><a href="#virtualEnvironment">virtualEnvironment</a></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td>The <code>virtualEnvironment</code> option is intended to support BYOD use-cases where the provisioning process bootstraps an alternative environment and associated policies.<div style="height:6pt;padding:0px"></div>Since the exact nature of such an environment is platform-dependent, it is necessary to find out what is actually available using the pre-defined extension URI <code>&quot;http://xmlns.webpki.org/keygen2/feature#ve&quot;</code>. The recommended method is adding the following to <a href="#InvocationRequest">InvocationRequest</a>:<div style="height:6pt;padding:0px"></div><code>&nbsp;&nbsp;&quot;clientCapabilityQuery&quot;:&nbsp;[&quot;http://xmlns.webpki.org/keygen2/feature#ve&quot;]</code><div style="height:6pt;padding:0px"></div>A possible <a href="#InvocationResponse">InvocationResponse</a> could be:<div style="height:6pt;padding:0px"></div><code>&nbsp;&nbsp;&quot;clientCapabilities&quot;:<br>&nbsp;&nbsp;&nbsp;&nbsp;[{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;type&quot;:&nbsp;&quot;http://xmlns.webpki.org/keygen2/feature#ve&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;values&quot;:&nbsp;[&quot;http://extreme-vm.com/type.3&quot;]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}]</code><div style="height:6pt;padding:0px"></div>If a virtual environment is already installed only the configuration should be updated. <div style="height:6pt;padding:0px"></div>Note that the <code>virtualEnvironment</code> option presumes that the <code>ProvisioningInitializationRequest</code> is <i>signed</i>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationRequest.nonce"><code>&quot;<span style="color:#C00000">nonce</span>&quot;:&nbsp;</code><code>&quot;</code><i>nonce</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">O</td><td><i>Optional</i> 1-32 byte nonce. The <code>nonce</code> value <b>must</b> be identical to the <code>nonce</code> specified in <a href="#InvocationResponse">InvocationResponse</a>. Also see <code>signature</code>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationRequest.signature"><code>&quot;<span style="color:#C00000">signature</span>&quot;:&nbsp;</code><a href="#signature">signature</a></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td><i>Optional</i> X.509-based signature covering the request including the <code>certificatePath</code> property. See <a href="#signature">signature</a>.<div style="height:6pt;padding:0px"></div>It is <b>recommended</b> using a commercial grade TLS certificate to avoid user security alerts. Note that <code>nonce</code> <b>must</b> be specified for a signed <code>ProvisioningInitializationRequest</code>.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="ProvisioningInitializationResponse">ProvisioningInitializationResponse</span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationResponse.context"><code>&quot;<span style="color:#606060">@context</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">http://xmlns.webpki.org/keygen2/beta/20150112</span>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">M</td><td>KeyGen2 name space/version indicator.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationResponse.qualifier"><code>&quot;<span style="color:#606060">@qualifier</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">ProvisioningInitializationResponse</span>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">M</td><td>Actual KeyGen2 message type.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationResponse.serverSessionId"><code>&quot;<span style="color:#C00000">serverSessionId</span>&quot;:&nbsp;</code><code>&quot;</code><i>serverSessionId</i><code>&quot;</code></td><td style="text-align:center">id</td><td style="text-align:center">M</td><td>See <code>SKS:createProvisioningSession.serverSessionId</code> and <a href="#InvocationRequest">InvocationRequest</a>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationResponse.clientSessionId"><code>&quot;<span style="color:#C00000">clientSessionId</span>&quot;:&nbsp;</code><code>&quot;</code><i>clientSessionId</i><code>&quot;</code></td><td style="text-align:center">id</td><td style="text-align:center">M</td><td>See <code>SKS:createProvisioningSession.clientSessionId</code>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationResponse.serverTime"><code>&quot;<span style="color:#C00000">serverTime</span>&quot;:&nbsp;</code><code>&quot;</code><i>serverTime</i><code>&quot;</code></td><td style="text-align:center">date</td><td style="text-align:center">M</td><td>Server time transferred verbatim from <a href="#ProvisioningInitializationRequest">ProvisioningInitializationRequest</a>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationResponse.clientTime"><code>&quot;<span style="color:#C00000">clientTime</span>&quot;:&nbsp;</code><code>&quot;</code><i>clientTime</i><code>&quot;</code></td><td style="text-align:center">date</td><td style="text-align:center">M</td><td>See <code>SKS:createProvisioningSession.clientTime</code>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationResponse.attestation"><code>&quot;<span style="color:#C00000">attestation</span>&quot;:&nbsp;</code><code>&quot;</code><i>attestation</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">M</td><td>See <code>SKS:createProvisioningSession.attestation</code>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationResponse.clientEphemeralKey"><code>&quot;<span style="color:#C00000">clientEphemeralKey</span>&quot;:&nbsp;</code><a href="#clientEphemeralKey">clientEphemeralKey</a></td><td style="text-align:center">object</td><td style="text-align:center">M</td><td>See <code>SKS:createProvisioningSession.clientEphemeralKey</code>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationResponse.deviceId"><code>&quot;<span style="color:#C00000">deviceId</span>&quot;:&nbsp;</code><a href="#deviceId">deviceId</a></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td>See <code>SKS:createProvisioningSession</code>. Note that this property is either required or forbidden depending on the value of <a href="#InvocationRequest.privacyEnabled">privacyEnabled</a>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationResponse.serverCertificateFingerPrint"><code>&quot;<span style="color:#C00000">serverCertificateFingerPrint</span>&quot;:&nbsp;</code><code>&quot;</code><i>serverCertificateFingerPrint</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">O</td><td>SHA256 fingerprint of the server's certificate during receival of the <a href="#ProvisioningInitializationRequest">ProvisioningInitializationRequest</a> object. <div style="height:6pt;padding:0px"></div>This property is mandatory for HTTPS connections.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningInitializationResponse.signature"><code>&quot;<span style="color:#C00000">signature</span>&quot;:&nbsp;</code><a href="#signature">signature</a></td><td style="text-align:center">object</td><td style="text-align:center">M</td><td>Symmetric key signature covering the entire response. See <code>SKS:signProvisioningSessionData</code>.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="CredentialDiscoveryRequest">CredentialDiscoveryRequest</span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="CredentialDiscoveryRequest.context"><code>&quot;<span style="color:#606060">@context</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">http://xmlns.webpki.org/keygen2/beta/20150112</span>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">M</td><td>KeyGen2 name space/version indicator.</td></tr><tr><td style="white-space:nowrap" id="CredentialDiscoveryRequest.qualifier"><code>&quot;<span style="color:#606060">@qualifier</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">CredentialDiscoveryRequest</span>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">M</td><td>Actual KeyGen2 message type.</td></tr><tr><td style="white-space:nowrap" id="CredentialDiscoveryRequest.serverSessionId"><code>&quot;<span style="color:#C00000">serverSessionId</span>&quot;:&nbsp;</code><code>&quot;</code><i>serverSessionId</i><code>&quot;</code></td><td style="text-align:center">id</td><td style="text-align:center">M</td><td>See <code>SKS:createProvisioningSession.serverSessionId</code> and <a href="#InvocationRequest">InvocationRequest</a>.</td></tr><tr><td style="white-space:nowrap" id="CredentialDiscoveryRequest.clientSessionId"><code>&quot;<span style="color:#C00000">clientSessionId</span>&quot;:&nbsp;</code><code>&quot;</code><i>clientSessionId</i><code>&quot;</code></td><td style="text-align:center">id</td><td style="text-align:center">M</td><td>See <code>SKS:createProvisioningSession.clientSessionId</code>.</td></tr><tr><td style="white-space:nowrap" id="CredentialDiscoveryRequest.submitUrl"><code>&quot;<span style="color:#C00000">submitUrl</span>&quot;:&nbsp;</code><code>&quot;</code><i>submitUrl</i><code>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">M</td><td>Where to POST the response.</td></tr><tr><td style="white-space:nowrap" id="CredentialDiscoveryRequest.lookupSpecifiers"><code>&quot;<span style="color:#C00000">lookupSpecifiers</span>&quot;:&nbsp;</code>[<a href="#lookupSpecifiers" style="margin-left:2pt;margin-right:2pt;">lookupSpecifiers</a>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">object</td><td style="text-align:center">M</td><td>List of signed credential lookup specifiers. See SKS appendix &quot;Remote Key Lookup&quot; for details.</td></tr><tr><td style="white-space:nowrap" id="CredentialDiscoveryRequest.signature"><code>&quot;<span style="color:#C00000">signature</span>&quot;:&nbsp;</code><a href="#signature">signature</a></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td><i>Optional</i> X.509-based signature covering the request including the <code>certificatePath</code> property. See <a href="#signature">signature</a>.<div style="height:6pt;padding:0px"></div>It is <b>recommended</b> using a commercial grade TLS certificate to avoid user security alerts.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="CredentialDiscoveryResponse">CredentialDiscoveryResponse</span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="CredentialDiscoveryResponse.context"><code>&quot;<span style="color:#606060">@context</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">http://xmlns.webpki.org/keygen2/beta/20150112</span>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">M</td><td>KeyGen2 name space/version indicator.</td></tr><tr><td style="white-space:nowrap" id="CredentialDiscoveryResponse.qualifier"><code>&quot;<span style="color:#606060">@qualifier</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">CredentialDiscoveryResponse</span>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">M</td><td>Actual KeyGen2 message type.</td></tr><tr><td style="white-space:nowrap" id="CredentialDiscoveryResponse.serverSessionId"><code>&quot;<span style="color:#C00000">serverSessionId</span>&quot;:&nbsp;</code><code>&quot;</code><i>serverSessionId</i><code>&quot;</code></td><td style="text-align:center">id</td><td style="text-align:center">M</td><td>See <code>SKS:createProvisioningSession.serverSessionId</code> and <a href="#InvocationRequest">InvocationRequest</a>.</td></tr><tr><td style="white-space:nowrap" id="CredentialDiscoveryResponse.clientSessionId"><code>&quot;<span style="color:#C00000">clientSessionId</span>&quot;:&nbsp;</code><code>&quot;</code><i>clientSessionId</i><code>&quot;</code></td><td style="text-align:center">id</td><td style="text-align:center">M</td><td>See <code>SKS:createProvisioningSession.clientSessionId</code>.</td></tr><tr><td style="white-space:nowrap" id="CredentialDiscoveryResponse.lookupResults"><code>&quot;<span style="color:#C00000">lookupResults</span>&quot;:&nbsp;</code>[<a href="#lookupResults" style="margin-left:2pt;margin-right:2pt;">lookupResults</a>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">object</td><td style="text-align:center">M</td><td>List of credential lookup results. See SKS appendix &quot;Remote Key Lookup&quot; for details.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="KeyCreationRequest">KeyCreationRequest</span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="KeyCreationRequest.context"><code>&quot;<span style="color:#606060">@context</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">http://xmlns.webpki.org/keygen2/beta/20150112</span>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">M</td><td>KeyGen2 name space/version indicator.</td></tr><tr><td style="white-space:nowrap" id="KeyCreationRequest.qualifier"><code>&quot;<span style="color:#606060">@qualifier</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">KeyCreationRequest</span>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">M</td><td>Actual KeyGen2 message type.</td></tr><tr><td style="white-space:nowrap" id="KeyCreationRequest.serverSessionId"><code>&quot;<span style="color:#C00000">serverSessionId</span>&quot;:&nbsp;</code><code>&quot;</code><i>serverSessionId</i><code>&quot;</code></td><td style="text-align:center">id</td><td style="text-align:center">M</td><td>See <code>SKS:createProvisioningSession.serverSessionId</code> and <a href="#InvocationRequest">InvocationRequest</a>.</td></tr><tr><td style="white-space:nowrap" id="KeyCreationRequest.clientSessionId"><code>&quot;<span style="color:#C00000">clientSessionId</span>&quot;:&nbsp;</code><code>&quot;</code><i>clientSessionId</i><code>&quot;</code></td><td style="text-align:center">id</td><td style="text-align:center">M</td><td>See <code>SKS:createProvisioningSession.clientSessionId</code>.</td></tr><tr><td style="white-space:nowrap" id="KeyCreationRequest.submitUrl"><code>&quot;<span style="color:#C00000">submitUrl</span>&quot;:&nbsp;</code><code>&quot;</code><i>submitUrl</i><code>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">M</td><td>Where to POST the response.</td></tr><tr><td style="white-space:nowrap" id="KeyCreationRequest.keyEntryAlgorithm"><code>&quot;<span style="color:#C00000">keyEntryAlgorithm</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">http://xmlns.webpki.org/sks/algorithm#key.1</span>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">M</td><td>See <code>SKS:createKeyEntry.keyEntryAlgorithm</code>.</td></tr><tr><td style="white-space:nowrap" id="KeyCreationRequest.deferredIssuance"><code>&quot;<span style="color:#C00000">deferredIssuance</span>&quot;:&nbsp;</code><i>deferredIssuance</i></td><td style="text-align:center">bool</td><td style="text-align:center">O</td><td>Flag telling if the process should be suspended after <a href="#KeyCreationResponse">KeyCreationResponse</a>.  Default value: <code>false</code>. See the <code>action</code> property in <a href="#InvocationRequest">InvocationRequest</a>.</td></tr><tr><td style="white-space:nowrap" id="KeyCreationRequest.pukPolicySpecifiers"><code>&quot;<span style="color:#C00000">pukPolicySpecifiers</span>&quot;:&nbsp;</code>[<a href="#pukPolicySpecifiers" style="margin-left:2pt;margin-right:2pt;">pukPolicySpecifiers</a>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td>List of PUK policy objects to be created. See <code>SKS:createPukPolicy</code>.</td></tr><tr><td style="white-space:nowrap" id="KeyCreationRequest.pinPolicySpecifiers"><code>&quot;<span style="color:#C00000">pinPolicySpecifiers</span>&quot;:&nbsp;</code>[<a href="#pinPolicySpecifiers" style="margin-left:2pt;margin-right:2pt;">pinPolicySpecifiers</a>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td>List of PIN policy objects to be created. See <code>SKS:createPinPolicy</code>.</td></tr><tr><td style="white-space:nowrap" id="KeyCreationRequest.keyEntrySpecifiers"><code>&quot;<span style="color:#C00000">keyEntrySpecifiers</span>&quot;:&nbsp;</code>[<a href="#keyEntrySpecifiers" style="margin-left:2pt;margin-right:2pt;">keyEntrySpecifiers</a>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td>List of key entries to be created. See <code>SKS:createKeyEntry</code>.</td></tr><tr><td style="white-space:nowrap" id="KeyCreationRequest.signature"><code>&quot;<span style="color:#C00000">signature</span>&quot;:&nbsp;</code><a href="#signature">signature</a></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td><i>Optional</i> X.509-based signature covering the request including the <code>certificatePath</code> property. See <a href="#signature">signature</a>.<div style="height:6pt;padding:0px"></div>It is <b>recommended</b> using a commercial grade TLS certificate to avoid user security alerts.</td></tr><tr><td colspan="4" style="background-color:white;border-width:0px;padding:10pt 0pt 0pt 0pt">Due to the stateful MAC-scheme featured in SKS, the properties beginning with <code>pukPolicySpecifiers</code> and ending with <code>keyEntrySpecifiers</code>, <b>must</b> <i>be generated (by the issuer) and executed (by the SKS) in exactly the order they are declared in this table as well as in associated object arrays</i>.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="KeyCreationResponse">KeyCreationResponse</span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="KeyCreationResponse.context"><code>&quot;<span style="color:#606060">@context</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">http://xmlns.webpki.org/keygen2/beta/20150112</span>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">M</td><td>KeyGen2 name space/version indicator.</td></tr><tr><td style="white-space:nowrap" id="KeyCreationResponse.qualifier"><code>&quot;<span style="color:#606060">@qualifier</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">KeyCreationResponse</span>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">M</td><td>Actual KeyGen2 message type.</td></tr><tr><td style="white-space:nowrap" id="KeyCreationResponse.serverSessionId"><code>&quot;<span style="color:#C00000">serverSessionId</span>&quot;:&nbsp;</code><code>&quot;</code><i>serverSessionId</i><code>&quot;</code></td><td style="text-align:center">id</td><td style="text-align:center">M</td><td>See <code>SKS:createProvisioningSession.serverSessionId</code> and <a href="#InvocationRequest">InvocationRequest</a>.</td></tr><tr><td style="white-space:nowrap" id="KeyCreationResponse.clientSessionId"><code>&quot;<span style="color:#C00000">clientSessionId</span>&quot;:&nbsp;</code><code>&quot;</code><i>clientSessionId</i><code>&quot;</code></td><td style="text-align:center">id</td><td style="text-align:center">M</td><td>See <code>SKS:createProvisioningSession.clientSessionId</code>.</td></tr><tr><td style="white-space:nowrap" id="KeyCreationResponse.generatedKeys"><code>&quot;<span style="color:#C00000">generatedKeys</span>&quot;:&nbsp;</code>[<a href="#generatedKeys" style="margin-left:2pt;margin-right:2pt;">generatedKeys</a>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">object</td><td style="text-align:center">M</td><td>List of generated keys. See <code>SKS:createKeyEntry</code>.</td></tr><tr><td colspan="4" style="background-color:white;border-width:0px;padding:10pt 0pt 0pt 0pt">Due to the stateful MAC-scheme featured in SKS, <code>generatedKeys</code> <b>must</b> <i>be encoded (by the SKS) and decoded (by the issuer) in exactly the same order (message-wise) as they are encountered in the associated</i>  <a href="#KeyCreationRequest.keyEntrySpecifiers">keyEntrySpecifiers</a> (including those embedded by <a href="#KeyCreationRequest.pinPolicySpecifiers">pinPolicySpecifiers</a>).</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="ProvisioningFinalizationRequest">ProvisioningFinalizationRequest</span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="ProvisioningFinalizationRequest.context"><code>&quot;<span style="color:#606060">@context</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">http://xmlns.webpki.org/keygen2/beta/20150112</span>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">M</td><td>KeyGen2 name space/version indicator.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningFinalizationRequest.qualifier"><code>&quot;<span style="color:#606060">@qualifier</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">ProvisioningFinalizationRequest</span>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">M</td><td>Actual KeyGen2 message type.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningFinalizationRequest.serverSessionId"><code>&quot;<span style="color:#C00000">serverSessionId</span>&quot;:&nbsp;</code><code>&quot;</code><i>serverSessionId</i><code>&quot;</code></td><td style="text-align:center">id</td><td style="text-align:center">M</td><td>See <code>SKS:createProvisioningSession.serverSessionId</code> and <a href="#InvocationRequest">InvocationRequest</a>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningFinalizationRequest.clientSessionId"><code>&quot;<span style="color:#C00000">clientSessionId</span>&quot;:&nbsp;</code><code>&quot;</code><i>clientSessionId</i><code>&quot;</code></td><td style="text-align:center">id</td><td style="text-align:center">M</td><td>See <code>SKS:createProvisioningSession.clientSessionId</code>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningFinalizationRequest.submitUrl"><code>&quot;<span style="color:#C00000">submitUrl</span>&quot;:&nbsp;</code><code>&quot;</code><i>submitUrl</i><code>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">M</td><td>Where to POST the response.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningFinalizationRequest.issuedCredentials"><code>&quot;<span style="color:#C00000">issuedCredentials</span>&quot;:&nbsp;</code>[<a href="#issuedCredentials" style="margin-left:2pt;margin-right:2pt;">issuedCredentials</a>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td><i>Optional:</i> List of issued credentials. See <code>SKS:setCertificatePath</code>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningFinalizationRequest.unlockKeys"><code>&quot;<span style="color:#C00000">unlockKeys</span>&quot;:&nbsp;</code>[<a href="#unlockKeys" style="margin-left:2pt;margin-right:2pt;">unlockKeys</a>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td><i>Optional:</i> List of keys to be unlocked. See <code>SKS:postUnlockKey</code>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningFinalizationRequest.deleteKeys"><code>&quot;<span style="color:#C00000">deleteKeys</span>&quot;:&nbsp;</code>[<a href="#deleteKeys" style="margin-left:2pt;margin-right:2pt;">deleteKeys</a>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td><i>Optional:</i> List of keys to be deleted. See <code>SKS:postDeleteKey</code>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningFinalizationRequest.nonce"><code>&quot;<span style="color:#C00000">nonce</span>&quot;:&nbsp;</code><code>&quot;</code><i>nonce</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">M</td><td>See <code>SKS:closeProvisioningSession</code>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningFinalizationRequest.mac"><code>&quot;<span style="color:#C00000">mac</span>&quot;:&nbsp;</code><code>&quot;</code><i>mac</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">M</td><td>Caller authentication. See <code>SKS:closeProvisioningSession.mac</code>.<div style="height:6pt;padding:0px"></div>Due to the stateful MAC-scheme featured in SKS, this <code>mac</code> <b>must</b> be the final of a provisioning session both during encoding and decoding.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningFinalizationRequest.signature"><code>&quot;<span style="color:#C00000">signature</span>&quot;:&nbsp;</code><a href="#signature">signature</a></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td><i>Optional</i> X.509-based signature covering the request including the <code>certificatePath</code> property. See <a href="#signature">signature</a>.<div style="height:6pt;padding:0px"></div>It is <b>recommended</b> using a commercial grade TLS certificate to avoid user security alerts.</td></tr><tr><td colspan="4" style="background-color:white;border-width:0px;padding:10pt 0pt 0pt 0pt">Due to the stateful MAC-scheme featured in SKS, the properties beginning with <code>issuedCredentials</code> and ending with <code>deleteKeys</code>, <b>must</b> <i>be generated (by the issuer) and executed (by the SKS) in exactly the order they are declared in this table as well as in associated object arrays</i>.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="ProvisioningFinalizationResponse">ProvisioningFinalizationResponse</span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="ProvisioningFinalizationResponse.context"><code>&quot;<span style="color:#606060">@context</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">http://xmlns.webpki.org/keygen2/beta/20150112</span>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">M</td><td>KeyGen2 name space/version indicator.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningFinalizationResponse.qualifier"><code>&quot;<span style="color:#606060">@qualifier</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">ProvisioningFinalizationResponse</span>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">M</td><td>Actual KeyGen2 message type.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningFinalizationResponse.serverSessionId"><code>&quot;<span style="color:#C00000">serverSessionId</span>&quot;:&nbsp;</code><code>&quot;</code><i>serverSessionId</i><code>&quot;</code></td><td style="text-align:center">id</td><td style="text-align:center">M</td><td>See <code>SKS:createProvisioningSession.serverSessionId</code> and <a href="#InvocationRequest">InvocationRequest</a>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningFinalizationResponse.clientSessionId"><code>&quot;<span style="color:#C00000">clientSessionId</span>&quot;:&nbsp;</code><code>&quot;</code><i>clientSessionId</i><code>&quot;</code></td><td style="text-align:center">id</td><td style="text-align:center">M</td><td>See <code>SKS:createProvisioningSession.clientSessionId</code>.</td></tr><tr><td style="white-space:nowrap" id="ProvisioningFinalizationResponse.attestation"><code>&quot;<span style="color:#C00000">attestation</span>&quot;:&nbsp;</code><code>&quot;</code><i>attestation</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">M</td><td>See <code>SKS:closeProvisioningSession</code>.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="keyManagementKey"><i>keyManagementKey</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="keyManagementKey.publicKey"><code>&quot;<span style="color:#C00000">publicKey</span>&quot;:&nbsp;</code><a href="#publicKey">publicKey</a></td><td style="text-align:center">object</td><td style="text-align:center">M</td><td>Actual key management key.</td></tr><tr><td style="white-space:nowrap" id="keyManagementKey.updatableKeyManagementKeys"><code>&quot;<span style="color:#C00000">updatableKeyManagementKeys</span>&quot;:&nbsp;</code>[<a href="#updatableKeyManagementKeys" style="margin-left:2pt;margin-right:2pt;">updatableKeyManagementKeys</a>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td><i>Optional:</i> List of the previous generation of key management keys.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="updatableKeyManagementKeys"><i>updatableKeyManagementKeys</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="updatableKeyManagementKeys.publicKey"><code>&quot;<span style="color:#C00000">publicKey</span>&quot;:&nbsp;</code><a href="#publicKey">publicKey</a></td><td style="text-align:center">object</td><td style="text-align:center">M</td><td>Previous generation key management key.<div style="height:6pt;padding:0px"></div>Note that <code>SKS:updateKeyManagementKey.keyManagementKey</code> refers to the <i>new</i> key management key specified in the object <i>immediately above</i> (=embedding) this <a href="#updatableKeyManagementKeys">updatableKeyManagementKeys</a> object.</td></tr><tr><td style="white-space:nowrap" id="updatableKeyManagementKeys.authorization"><code>&quot;<span style="color:#C00000">authorization</span>&quot;:&nbsp;</code><code>&quot;</code><i>authorization</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">M</td><td>Authorization of the new key management key. See <code>SKS:updateKeyManagementKey.authorization</code>.</td></tr><tr><td style="white-space:nowrap" id="updatableKeyManagementKeys.updatableKeyManagementKeys"><code>&quot;<span style="color:#C00000">updatableKeyManagementKeys</span>&quot;:&nbsp;</code>[<a href="#updatableKeyManagementKeys" style="margin-left:2pt;margin-right:2pt;">updatableKeyManagementKeys</a>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td><i>Optional:</i> List of the previous generation of key management keys.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="virtualEnvironment"><i>virtualEnvironment</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="virtualEnvironment.type"><code>&quot;<span style="color:#C00000">type</span>&quot;:&nbsp;</code><code>&quot;</code><i>type</i><code>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">M</td><td>Virtual environment specific type URI like <code>&quot;http://extreme-vm.com/type.3&quot;</code>.</td></tr><tr><td style="white-space:nowrap" id="virtualEnvironment.configuration"><code>&quot;<span style="color:#C00000">configuration</span>&quot;:&nbsp;</code><code>&quot;</code><i>configuration</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">M</td><td>Virtual environment specific configuration (setup) data.</td></tr><tr><td style="white-space:nowrap" id="virtualEnvironment.friendlyName"><code>&quot;<span style="color:#C00000">friendlyName</span>&quot;:&nbsp;</code><code>&quot;</code><i>friendlyName</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">M</td><td>Virtual environment friendly name.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="lookupSpecifiers"><i>lookupSpecifiers</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="lookupSpecifiers.id"><code>&quot;<span style="color:#C00000">id</span>&quot;:&nbsp;</code><code>&quot;</code><i>id</i><code>&quot;</code></td><td style="text-align:center">id</td><td style="text-align:center">M</td><td>Each specifier <b>must</b> have a unique ID.</td></tr><tr><td style="white-space:nowrap" id="lookupSpecifiers.nonce"><code>&quot;<span style="color:#C00000">nonce</span>&quot;:&nbsp;</code><code>&quot;</code><i>nonce</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">M</td><td><code>nonce</code> data. See SKS appendix &quot;Remote Key Lookup&quot; for details.</td></tr><tr><td style="white-space:nowrap" id="lookupSpecifiers.searchFilter"><code>&quot;<span style="color:#C00000">searchFilter</span>&quot;:&nbsp;</code><a href="#searchFilter">searchFilter</a></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td><i>Optional</i> additional search conditions.<div style="height:6pt;padding:0px"></div>Note that at least one search condition <b>must</b> be specified if this option is used. The result of each condition is combined through a logical AND operation.</td></tr><tr><td style="white-space:nowrap" id="lookupSpecifiers.signature"><code>&quot;<span style="color:#C00000">signature</span>&quot;:&nbsp;</code><a href="#signature">signature</a></td><td style="text-align:center">object</td><td style="text-align:center">M</td><td>Signature using a key management key signature covering the lookup specifier. Note that the <code>publicKey</code> property <b>must</b> be present. See SKS appendix &quot;Remote Key Lookup&quot; for details.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="searchFilter"><i>searchFilter</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="searchFilter.fingerPrint"><code>&quot;<span style="color:#C00000">fingerPrint</span>&quot;:&nbsp;</code><code>&quot;</code><i>fingerPrint</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">O</td><td>SHA256 fingerprint matching any certificate in the <i>certificate path</i>.</td></tr><tr><td style="white-space:nowrap" id="searchFilter.issuerRegEx"><code>&quot;<span style="color:#C00000">issuerRegEx</span>&quot;:&nbsp;</code><code>&quot;</code><i>issuerRegEx</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">O</td><td>Regular expression matching any issuer in the <i>certificate path</i>. Issuer names are assumed to be expressed in LDAP <a href="#Reference.RFC4514">[RFC4514]</a> notation.</td></tr><tr><td style="white-space:nowrap" id="searchFilter.serialNumber"><code>&quot;<span style="color:#C00000">serialNumber</span>&quot;:&nbsp;</code><code>&quot;</code><i>serialNumber</i><code>&quot;</code></td><td style="text-align:center">bigint</td><td style="text-align:center">O</td><td>Serial number matching that of the <i>end-entity certificate</i>.</td></tr><tr><td style="white-space:nowrap" id="searchFilter.subjectRegEx"><code>&quot;<span style="color:#C00000">subjectRegEx</span>&quot;:&nbsp;</code><code>&quot;</code><i>subjectRegEx</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">O</td><td>Regular expression matching the subject in the <i>end-entity certificate</i>. Subject names are assumed to be expressed in LDAP <a href="#Reference.RFC4514">[RFC4514]</a> notation.</td></tr><tr><td style="white-space:nowrap" id="searchFilter.emailRegEx"><code>&quot;<span style="color:#C00000">emailRegEx</span>&quot;:&nbsp;</code><code>&quot;</code><i>emailRegEx</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">O</td><td>Regular expression matching any of the e-mail addresses in the <i>end-entity certificate</i>.<div style="height:6pt;padding:0px"></div>Note that both RFC&nbsp;822 subject attributes and <code>subjectAltName</code> fields are in scope.</td></tr><tr><td style="white-space:nowrap" id="searchFilter.policyRules"><code>&quot;<span style="color:#C00000">policyRules</span>&quot;:&nbsp;</code>[<code>&quot;</code><i>policyRules</i><code>&quot;</code>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">string</td><td style="text-align:center">O</td><td>List of X.509 policy extension OIDs using the notation <code style="white-space:nowrap">&quot;1.4.3&quot;</code> and <code style="white-space:nowrap">&quot;-1.4.7&quot;</code> for a required and forbidden policy OID respectively.<div style="height:6pt;padding:0px"></div>Policy OIDs encountered in <i>end-entity certificates</i> that are not specified in <code>policyRules</code> <b>must</b> be <i>ignored</i>.</td></tr><tr><td style="white-space:nowrap" id="searchFilter.keyUsageRules"><code>&quot;<span style="color:#C00000">keyUsageRules</span>&quot;:&nbsp;</code>[<code>&quot;</code><i>keyUsageRules</i><code>&quot;</code>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">string</td><td style="text-align:center">O</td><td>List of X.509 key usage flags using the notation <code>&quot;digitalSignature&quot;</code> and <code style="white-space:nowrap">&quot;-dataEncipherment&quot;</code> for a required and forbidden key usage respectively.<div style="height:6pt;padding:0px"></div>Key usage flags encountered in <i>end-entity certificates</i> that are not specified in <code>keyUsageRules</code> <b>must</b> be <i>ignored</i>. <div style="height:6pt;padding:0px"></div>The set of permitted flags include:<ul><li><code>digitalSignature</code></li><li><code>nonRepudiation</code></li><li><code>keyEncipherment</code></li><li><code>dataEncipherment</code></li><li><code>keyAgreement</code></li><li><code>keyCertSign</code></li><li><code>cRLSign</code></li><li><code>encipherOnly</code></li><li><code>decipherOnly</code></li></ul></td></tr><tr><td style="white-space:nowrap" id="searchFilter.extendedKeyUsageRules"><code>&quot;<span style="color:#C00000">extendedKeyUsageRules</span>&quot;:&nbsp;</code>[<code>&quot;</code><i>extendedKeyUsageRules</i><code>&quot;</code>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">string</td><td style="text-align:center">O</td><td>List of X.509 extended key usage extension OIDs using the notation <code style="white-space:nowrap">&quot;1.4.3&quot;</code> and <code style="white-space:nowrap">&quot;-1.4.7&quot;</code> for a required and forbidden extended key usage respectively.<div style="height:6pt;padding:0px"></div>Extended key usage OIDs encountered in <i>end-entity certificates</i> that are not specified in <code>extendedKeyUsageRules</code> <b>must</b> be <i>ignored</i>.</td></tr><tr><td style="white-space:nowrap" id="searchFilter.issuedBefore"><code>&quot;<span style="color:#C00000">issuedBefore</span>&quot;:&nbsp;</code><code>&quot;</code><i>issuedBefore</i><code>&quot;</code></td><td style="text-align:center">date</td><td style="text-align:center">O</td><td>Matching <i>end-entity certificates</i> issued before this date.<div style="height:6pt;padding:0px"></div>Note that you can combine this condition with an <code>issuedAfter</code> condition using an earlier date, effectively creating a time window.</td></tr><tr><td style="white-space:nowrap" id="searchFilter.issuedAfter"><code>&quot;<span style="color:#C00000">issuedAfter</span>&quot;:&nbsp;</code><code>&quot;</code><i>issuedAfter</i><code>&quot;</code></td><td style="text-align:center">date</td><td style="text-align:center">O</td><td>Matching <i>end-entity certificates</i> issued after this date.</td></tr><tr><td style="white-space:nowrap" id="searchFilter.grouping"><code>&quot;<span style="color:#C00000">grouping</span>&quot;:&nbsp;</code><code>&quot;</code><i>grouping</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">O</td><td>Matching keys based on the <code>SKS:createPinPolicy.grouping</code> attribute.<div style="height:6pt;padding:0px"></div>Note that keys that are not PIN-protected <b>must</b> always fail to match.</td></tr><tr><td style="white-space:nowrap" id="searchFilter.appUsage"><code>&quot;<span style="color:#C00000">appUsage</span>&quot;:&nbsp;</code><code>&quot;</code><i>appUsage</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">O</td><td>Matching keys based on the <code>SKS:createKeyEntry.appUsage</code> attribute.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="lookupResults"><i>lookupResults</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="lookupResults.id"><code>&quot;<span style="color:#C00000">id</span>&quot;:&nbsp;</code><code>&quot;</code><i>id</i><code>&quot;</code></td><td style="text-align:center">id</td><td style="text-align:center">M</td><td>Each result <b>must</b> have a unique ID matching the request.</td></tr><tr><td style="white-space:nowrap" id="lookupResults.matchingCredentials"><code>&quot;<span style="color:#C00000">matchingCredentials</span>&quot;:&nbsp;</code>[<a href="#matchingCredentials" style="margin-left:2pt;margin-right:2pt;">matchingCredentials</a>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;0-n</span></td><td style="text-align:center">object</td><td style="text-align:center">M</td><td>List of matching credentials.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="matchingCredentials"><i>matchingCredentials</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="matchingCredentials.serverSessionId"><code>&quot;<span style="color:#C00000">serverSessionId</span>&quot;:&nbsp;</code><code>&quot;</code><i>serverSessionId</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">M</td><td><code>serverSessionId</code> of matching credential.</td></tr><tr><td style="white-space:nowrap" id="matchingCredentials.clientSessionId"><code>&quot;<span style="color:#C00000">clientSessionId</span>&quot;:&nbsp;</code><code>&quot;</code><i>clientSessionId</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">M</td><td><code>clientSessionId</code> of matching credential.</td></tr><tr><td style="white-space:nowrap" id="matchingCredentials.certificatePath"><code>&quot;<span style="color:#C00000">certificatePath</span>&quot;:&nbsp;</code>[<code>&quot;</code><i>Sorted Certificate Path</i><code>&quot;</code>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">base64</td><td style="text-align:center">M</td><td>Identical representation as the <code>certificatePath</code> in <a href="#signature">signature</a>.</td></tr><tr><td style="white-space:nowrap" id="matchingCredentials.locked"><code>&quot;<span style="color:#C00000">locked</span>&quot;:&nbsp;</code><i>locked</i></td><td style="text-align:center">bool</td><td style="text-align:center">O</td><td>If this property is <code>true</code> the key associated with the credential is locked due to multiple PIN errors. The default value is <code>false</code>.  See <a href="#ProvisioningFinalizationRequest.unlockKeys">unlockKeys</a>.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="pukPolicySpecifiers"><i>pukPolicySpecifiers</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="pukPolicySpecifiers.id"><code>&quot;<span style="color:#C00000">id</span>&quot;:&nbsp;</code><code>&quot;</code><i>id</i><code>&quot;</code></td><td style="text-align:center">id</td><td style="text-align:center">M</td><td>See <code>SKS:createPukPolicy.id</code>.</td></tr><tr><td style="white-space:nowrap" id="pukPolicySpecifiers.encryptedPuk"><code>&quot;<span style="color:#C00000">encryptedPuk</span>&quot;:&nbsp;</code><code>&quot;</code><i>encryptedPuk</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">M</td><td>See <code>SKS:createPukPolicy.encryptedPuk</code>.</td></tr><tr><td style="white-space:nowrap" id="pukPolicySpecifiers.retryLimit"><code>&quot;<span style="color:#C00000">retryLimit</span>&quot;:&nbsp;</code><i>retryLimit</i></td><td style="text-align:center">ushort</td><td style="text-align:center">M</td><td>See <code>SKS:createPukPolicy.retryLimit</code>.</td></tr><tr><td style="white-space:nowrap" id="pukPolicySpecifiers.format"><code>&quot;<span style="color:#C00000">format</span>&quot;:&nbsp;</code><code>&quot;</code><i>format</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">M</td><td>See <code>SKS:createPukPolicy.format</code>.</td></tr><tr><td style="white-space:nowrap" id="pukPolicySpecifiers.mac"><code>&quot;<span style="color:#C00000">mac</span>&quot;:&nbsp;</code><code>&quot;</code><i>mac</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">M</td><td>Caller authentication. See <code>SKS:createPukPolicy.mac</code>.</td></tr><tr><td style="white-space:nowrap" id="pukPolicySpecifiers.pinPolicySpecifiers"><code>&quot;<span style="color:#C00000">pinPolicySpecifiers</span>&quot;:&nbsp;</code>[<a href="#pinPolicySpecifiers" style="margin-left:2pt;margin-right:2pt;">pinPolicySpecifiers</a>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">object</td><td style="text-align:center">M</td><td>List of PIN policy objects to be created and controlled by this PUK policy. See <code>SKS:createPinPolicy</code>.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="pinPolicySpecifiers"><i>pinPolicySpecifiers</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="pinPolicySpecifiers.id"><code>&quot;<span style="color:#C00000">id</span>&quot;:&nbsp;</code><code>&quot;</code><i>id</i><code>&quot;</code></td><td style="text-align:center">id</td><td style="text-align:center">M</td><td>See <code>SKS:createPinPolicy.id</code>.</td></tr><tr><td style="white-space:nowrap" id="pinPolicySpecifiers.minLength"><code>&quot;<span style="color:#C00000">minLength</span>&quot;:&nbsp;</code><i>minLength</i></td><td style="text-align:center">ushort</td><td style="text-align:center">M</td><td>See <code>SKS:createPinPolicy.minLength</code>.</td></tr><tr><td style="white-space:nowrap" id="pinPolicySpecifiers.maxLength"><code>&quot;<span style="color:#C00000">maxLength</span>&quot;:&nbsp;</code><i>maxLength</i></td><td style="text-align:center">ushort</td><td style="text-align:center">M</td><td>See <code>SKS:createPinPolicy.maxLength</code>.</td></tr><tr><td style="white-space:nowrap" id="pinPolicySpecifiers.retryLimit"><code>&quot;<span style="color:#C00000">retryLimit</span>&quot;:&nbsp;</code><i>retryLimit</i></td><td style="text-align:center">ushort</td><td style="text-align:center">M</td><td>See <code>SKS:createPinPolicy.retryLimit</code>.</td></tr><tr><td style="white-space:nowrap" id="pinPolicySpecifiers.format"><code>&quot;<span style="color:#C00000">format</span>&quot;:&nbsp;</code><code>&quot;</code><i>format</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">M</td><td>See <code>SKS:createPinPolicy.format</code>.</td></tr><tr><td style="white-space:nowrap" id="pinPolicySpecifiers.userModifiable"><code>&quot;<span style="color:#C00000">userModifiable</span>&quot;:&nbsp;</code><i>userModifiable</i></td><td style="text-align:center">bool</td><td style="text-align:center">O</td><td>Flag with the default value <code>true</code>.<br>See <code>SKS:createPinPolicy.userModifiable</code>.</td></tr><tr><td style="white-space:nowrap" id="pinPolicySpecifiers.grouping"><code>&quot;<span style="color:#C00000">grouping</span>&quot;:&nbsp;</code><code>&quot;</code><i>grouping</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">O</td><td>Grouping specifier with the default value <code>none</code>.<br>See <code>SKS:createPINPolicy.grouping</code>.</td></tr><tr><td style="white-space:nowrap" id="pinPolicySpecifiers.inputMethod"><code>&quot;<span style="color:#C00000">inputMethod</span>&quot;:&nbsp;</code><code>&quot;</code><i>inputMethod</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">O</td><td>Input method specifier with the default value <code>any</code>.<br>See <code>SKS:createPinPolicy.inputMethod</code>.</td></tr><tr><td style="white-space:nowrap" id="pinPolicySpecifiers.patternRestrictions"><code>&quot;<span style="color:#C00000">patternRestrictions</span>&quot;:&nbsp;</code>[<code>&quot;</code><i>patternRestrictions</i><code>&quot;</code>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">string</td><td style="text-align:center">O</td><td>List of pattern restrictions.  See <code>SKS:createPinPolicy.patternRestrictions</code>.<br>If this property is undefined, there are no PIN pattern restrictions.</td></tr><tr><td style="white-space:nowrap" id="pinPolicySpecifiers.mac"><code>&quot;<span style="color:#C00000">mac</span>&quot;:&nbsp;</code><code>&quot;</code><i>mac</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">M</td><td>Caller authentication. See <code>SKS:createPinPolicy.mac</code>.</td></tr><tr><td style="white-space:nowrap" id="pinPolicySpecifiers.keyEntrySpecifiers"><code>&quot;<span style="color:#C00000">keyEntrySpecifiers</span>&quot;:&nbsp;</code>[<a href="#keyEntrySpecifiers" style="margin-left:2pt;margin-right:2pt;">keyEntrySpecifiers</a>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">object</td><td style="text-align:center">M</td><td>List of key entries to be created and controlled by this PIN policy.<br>See <code>SKS:createKeyEntry</code>.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="keyEntrySpecifiers"><i>keyEntrySpecifiers</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="keyEntrySpecifiers.id"><code>&quot;<span style="color:#C00000">id</span>&quot;:&nbsp;</code><code>&quot;</code><i>id</i><code>&quot;</code></td><td style="text-align:center">id</td><td style="text-align:center">M</td><td>See <code>SKS:createKeyEntry.id</code>.</td></tr><tr><td style="white-space:nowrap" id="keyEntrySpecifiers.encryptedPin"><code>&quot;<span style="color:#C00000">encryptedPin</span>&quot;:&nbsp;</code><code>&quot;</code><i>encryptedPin</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">O</td><td>See <code>SKS:createKeyEntry.pinValue</code>.<br>Note that if this property is defined, the <code>SKS:createPinPolicy.userDefined</code> flag of the required embedding PIN policy is set to <code>false</code> else it is set to <code>true</code>.<div style="height:6pt;padding:0px"></div>Keys associated with a specific PIN policy <b>must not</b> mix user-defined and preset PINs.</td></tr><tr><td style="white-space:nowrap" id="keyEntrySpecifiers.enablePinCaching"><code>&quot;<span style="color:#C00000">enablePinCaching</span>&quot;:&nbsp;</code><i>enablePinCaching</i></td><td style="text-align:center">bool</td><td style="text-align:center">O</td><td>Flag with the default value <code>false</code>.<br>See <code>SKS:createKeyEntry.enablePinCaching</code>.</td></tr><tr><td style="white-space:nowrap" id="keyEntrySpecifiers.devicePinProtection"><code>&quot;<span style="color:#C00000">devicePinProtection</span>&quot;:&nbsp;</code><i>devicePinProtection</i></td><td style="text-align:center">bool</td><td style="text-align:center">O</td><td>Flag with the default value <code>false</code>.<br>See <code>SKS:createKeyEntry.devicePinProtection</code>. <div style="height:6pt;padding:0px"></div>Note that this flag (if true) cannot be combined with PIN policy settings.</td></tr><tr><td style="white-space:nowrap" id="keyEntrySpecifiers.appUsage"><code>&quot;<span style="color:#C00000">appUsage</span>&quot;:&nbsp;</code><code>&quot;</code><i>appUsage</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">M</td><td>See <code>SKS:createKeyEntry.appUsage</code>.</td></tr><tr><td style="white-space:nowrap" id="keyEntrySpecifiers.keyAlgorithm"><code>&quot;<span style="color:#C00000">keyAlgorithm</span>&quot;:&nbsp;</code><code>&quot;</code><i>keyAlgorithm</i><code>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">M</td><td>See <code>SKS:createKeyEntry.keyAlgorithm</code>. Also see SKS &quot;Algorithm Support&quot;.<div style="height:6pt;padding:0px"></div>The currently recognized key algorithms include:<ul><li><code>http://xmlns.webpki.org/sks/algorithm#rsa1024</code></li><li><code>http://xmlns.webpki.org/sks/algorithm#rsa2048</code></li><li><code>http://xmlns.webpki.org/sks/algorithm#rsa3072</code></li><li><code>http://xmlns.webpki.org/sks/algorithm#rsa4096</code></li><li><code>http://xmlns.webpki.org/sks/algorithm#rsa1024.exp</code></li><li><code>http://xmlns.webpki.org/sks/algorithm#rsa2048.exp</code></li><li><code>http://xmlns.webpki.org/sks/algorithm#rsa3072.exp</code></li><li><code>http://xmlns.webpki.org/sks/algorithm#rsa4096.exp</code></li><li><code>http://xmlns.webpki.org/sks/algorithm#ec.nist.b163</code></li><li><code>http://xmlns.webpki.org/sks/algorithm#ec.nist.b233</code></li><li><code>http://xmlns.webpki.org/sks/algorithm#ec.nist.b283</code></li><li><code>http://xmlns.webpki.org/sks/algorithm#ec.nist.p192</code></li><li><code>http://xmlns.webpki.org/sks/algorithm#ec.nist.p256</code></li><li><code>http://xmlns.webpki.org/sks/algorithm#ec.nist.p384</code></li><li><code>http://xmlns.webpki.org/sks/algorithm#ec.nist.p521</code></li><li><code>http://xmlns.webpki.org/sks/algorithm#ec.secg.p256k1</code></li><li><code>http://xmlns.webpki.org/sks/algorithm#ec.brainpool.p256r1</code></li></ul></td></tr><tr><td style="white-space:nowrap" id="keyEntrySpecifiers.keyParameters"><code>&quot;<span style="color:#C00000">keyParameters</span>&quot;:&nbsp;</code><code>&quot;</code><i>keyParameters</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">O</td><td>See <code>SKS:createKeyEntry.keyParameters</code>.</td></tr><tr><td style="white-space:nowrap" id="keyEntrySpecifiers.endorsedAlgorithms"><code>&quot;<span style="color:#C00000">endorsedAlgorithms</span>&quot;:&nbsp;</code>[<code>&quot;</code><i>List of URIs</i><code>&quot;</code>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">uri</td><td style="text-align:center">O</td><td>See <code>SKS:createKeyEntry.endorsedAlgorithms</code>. Also see SKS &quot;Algorithm Support&quot;.<div style="height:6pt;padding:0px"></div>Note that <i>endorsed algorithm URIs <b>must</b> be specified in strict lexical order</i>.<div style="height:6pt;padding:0px"></div>The currently recognized algorithms include:<ul><li><code>http://www.w3.org/2000/09/xmldsig#hmac-sha1</code></li><li><code>http://www.w3.org/2001/04/xmldsig-more#hmac-sha256</code></li><li><code>http://www.w3.org/2001/04/xmldsig-more#hmac-sha384</code></li><li><code>http://www.w3.org/2001/04/xmldsig-more#hmac-sha512</code></li></ul><ul><li><code>http://xmlns.webpki.org/sks/algorithm#rsa.pkcs1.none</code></li><li><code>http://www.w3.org/2000/09/xmldsig#rsa-sha1</code></li><li><code>http://www.w3.org/2001/04/xmldsig-more#rsa-sha256</code></li><li><code>http://www.w3.org/2001/04/xmldsig-more#rsa-sha384</code></li><li><code>http://www.w3.org/2001/04/xmldsig-more#rsa-sha512</code></li><li><code>http://xmlns.webpki.org/sks/algorithm#ecdsa.none</code></li><li><code>http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha256</code></li><li><code>http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha384</code></li><li><code>http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha512</code></li></ul><ul><li><code>http://xmlns.webpki.org/sks/algorithm#rsa.es.pkcs1_5</code></li><li><code>http://xmlns.webpki.org/sks/algorithm#rsa.oaep.sha1.mgf1p</code></li><li><code>http://xmlns.webpki.org/sks/algorithm#rsa.oaep.sha256.mgf1p</code></li><li><code>http://xmlns.webpki.org/sks/algorithm#rsa.raw</code></li></ul><ul><li><code>http://www.w3.org/2001/04/xmlenc#aes128-cbc</code></li><li><code>http://www.w3.org/2001/04/xmlenc#aes192-cbc</code></li><li><code>http://www.w3.org/2001/04/xmlenc#aes256-cbc</code></li><li><code>http://www.w3.org/2001/04/xmlenc#kw-aes128</code></li><li><code>http://www.w3.org/2001/04/xmlenc#kw-aes256</code></li><li><code>http://xmlns.webpki.org/sks/algorithm#aes.ecb.nopad</code></li><li><code>http://xmlns.webpki.org/sks/algorithm#aes.ecb</code></li><li><code>http://xmlns.webpki.org/sks/algorithm#aes.cbc.nopad</code></li><li><code>http://xmlns.webpki.org/sks/algorithm#aes.cbc</code></li></ul><ul><li><code>http://xmlns.webpki.org/sks/algorithm#ecdh.raw</code></li></ul><ul><li><code>http://xmlns.webpki.org/sks/algorithm#none</code></li></ul></td></tr><tr><td style="white-space:nowrap" id="keyEntrySpecifiers.serverSeed"><code>&quot;<span style="color:#C00000">serverSeed</span>&quot;:&nbsp;</code><code>&quot;</code><i>serverSeed</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">O</td><td>See <code>SKS:createKeyEntry.serverSeed</code>. If this property is undefined, it is assumed to be a zero-length array.</td></tr><tr><td style="white-space:nowrap" id="keyEntrySpecifiers.biometricProtection"><code>&quot;<span style="color:#C00000">biometricProtection</span>&quot;:&nbsp;</code><code>&quot;</code><i>biometricProtection</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">O</td><td>See <code>SKS:createKeyEntry.biometricProtection</code>. The default value is <code>none</code>.</td></tr><tr><td style="white-space:nowrap" id="keyEntrySpecifiers.deleteProtection"><code>&quot;<span style="color:#C00000">deleteProtection</span>&quot;:&nbsp;</code><code>&quot;</code><i>deleteProtection</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">O</td><td>See <code>SKS:createKeyEntry.deleteProtection</code>. The default value is <code>none</code>.</td></tr><tr><td style="white-space:nowrap" id="keyEntrySpecifiers.exportProtection"><code>&quot;<span style="color:#C00000">exportProtection</span>&quot;:&nbsp;</code><code>&quot;</code><i>exportProtection</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">O</td><td>See <code>SKS:createKeyEntry.exportProtection</code>. The default value is <code style="white-space:nowrap">non-exportable</code>.</td></tr><tr><td style="white-space:nowrap" id="keyEntrySpecifiers.friendlyName"><code>&quot;<span style="color:#C00000">friendlyName</span>&quot;:&nbsp;</code><code>&quot;</code><i>friendlyName</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">O</td><td>See <code>SKS:createKeyEntry.friendlyName</code>.</td></tr><tr><td style="white-space:nowrap" id="keyEntrySpecifiers.mac"><code>&quot;<span style="color:#C00000">mac</span>&quot;:&nbsp;</code><code>&quot;</code><i>mac</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">M</td><td>Caller authentication. See <code>SKS:createKeyEntry.mac</code>.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="generatedKeys"><i>generatedKeys</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="generatedKeys.id"><code>&quot;<span style="color:#C00000">id</span>&quot;:&nbsp;</code><code>&quot;</code><i>id</i><code>&quot;</code></td><td style="text-align:center">id</td><td style="text-align:center">M</td><td><code>id</code> <b>must</b> match the identifier used in <a href="#KeyCreationRequest">KeyCreationRequest</a> for a specific key.</td></tr><tr><td style="white-space:nowrap" id="generatedKeys.publicKey"><code>&quot;<span style="color:#C00000">publicKey</span>&quot;:&nbsp;</code><a href="#publicKey">publicKey</a></td><td style="text-align:center">object</td><td style="text-align:center">M</td><td>See <code>SKS:createKeyEntry.publicKey</code>.</td></tr><tr><td style="white-space:nowrap" id="generatedKeys.attestation"><code>&quot;<span style="color:#C00000">attestation</span>&quot;:&nbsp;</code><code>&quot;</code><i>attestation</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">M</td><td>See <code>SKS:createKeyEntry.attestation</code>.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="issuedCredentials"><i>issuedCredentials</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="issuedCredentials.id"><code>&quot;<span style="color:#C00000">id</span>&quot;:&nbsp;</code><code>&quot;</code><i>id</i><code>&quot;</code></td><td style="text-align:center">id</td><td style="text-align:center">M</td><td>See <code>SKS:setCertificatePath.id</code>.<br><code>id</code> <b>must</b> match the identifier used in <a href="#KeyCreationRequest">KeyCreationRequest</a> for a specific key.</td></tr><tr><td style="white-space:nowrap" id="issuedCredentials.certificatePath"><code>&quot;<span style="color:#C00000">certificatePath</span>&quot;:&nbsp;</code>[<code>&quot;</code><i>Sorted Certificate Path</i><code>&quot;</code>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">base64</td><td style="text-align:center">M</td><td>See <code>SKS:setCertificatePath.certificate...</code>.<br>Identical representation as the <code>certificatePath</code> in <a href="#signature">signature</a>.</td></tr><tr><td style="white-space:nowrap" id="issuedCredentials.mac"><code>&quot;<span style="color:#C00000">mac</span>&quot;:&nbsp;</code><code>&quot;</code><i>mac</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">M</td><td>Caller authentication. See <code>SKS:setCertificatePath.mac</code>.</td></tr><tr><td style="white-space:nowrap" id="issuedCredentials.trustAnchor"><code>&quot;<span style="color:#C00000">trustAnchor</span>&quot;:&nbsp;</code><i>trustAnchor</i></td><td style="text-align:center">bool</td><td style="text-align:center">O</td><td><i>Optional:</i> Flag (with the default value <code>false</code>), which tells if <code>certificatePath</code> contains a user-installable trust anchor as well.<div style="height:6pt;padding:0px"></div>Trust anchor installation is meant to be <i>independent</i> of SKS provisioning.</td></tr><tr><td style="white-space:nowrap" id="issuedCredentials.importSymmetricKey"><code>&quot;<span style="color:#C00000">importSymmetricKey</span>&quot;:&nbsp;</code><a href="#importSymmetricKey">importSymmetricKey</a></td><td style="text-align:center">object</td><td style="text-align:center" rowspan="2">O</td><td><i>Optional:</i> Import of raw symmetric key. See <code>SKS:importSymmetricKey</code>.</td></tr><tr><td style="white-space:nowrap" id="issuedCredentials.importPrivateKey"><code>&quot;<span style="color:#C00000">importPrivateKey</span>&quot;:&nbsp;</code><a href="#importPrivateKey">importPrivateKey</a></td><td style="text-align:center">object</td><td><i>Optional:</i> Import of private key in PKCS #8 <a href="#Reference.RFC5208">[RFC5208]</a> format. See <code>SKS:importPrivateKey</code>.</td></tr><tr><td style="white-space:nowrap" id="issuedCredentials.updateKey"><code>&quot;<span style="color:#C00000">updateKey</span>&quot;:&nbsp;</code><a href="#updateKey">updateKey</a></td><td style="text-align:center">object</td><td style="text-align:center" rowspan="2">O</td><td><i>Optional</i>: See <code>SKS:postUpdateKey</code>.</td></tr><tr><td style="white-space:nowrap" id="issuedCredentials.cloneKeyProtection"><code>&quot;<span style="color:#C00000">cloneKeyProtection</span>&quot;:&nbsp;</code><a href="#cloneKeyProtection">cloneKeyProtection</a></td><td style="text-align:center">object</td><td><i>Optional</i>: See <code>SKS:postCloneKeyProtection</code>.</td></tr><tr><td style="white-space:nowrap" id="issuedCredentials.extensions"><code>&quot;<span style="color:#C00000">extensions</span>&quot;:&nbsp;</code>[<a href="#extensions" style="margin-left:2pt;margin-right:2pt;">extensions</a>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td><i>Optional:</i> List of extension objects. See <code>SKS:addExtension</code>.</td></tr><tr><td style="white-space:nowrap" id="issuedCredentials.encryptedExtensions"><code>&quot;<span style="color:#C00000">encryptedExtensions</span>&quot;:&nbsp;</code>[<a href="#encryptedExtensions" style="margin-left:2pt;margin-right:2pt;">encryptedExtensions</a>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td><i>Optional:</i> List of encrypted extension objects. See <code>SKS:addExtension</code>.</td></tr><tr><td style="white-space:nowrap" id="issuedCredentials.propertyBags"><code>&quot;<span style="color:#C00000">propertyBags</span>&quot;:&nbsp;</code>[<a href="#propertyBags" style="margin-left:2pt;margin-right:2pt;">propertyBags</a>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td><i>Optional:</i> List of property objects. See <code>SKS:addExtension</code>.</td></tr><tr><td style="white-space:nowrap" id="issuedCredentials.logotypes"><code>&quot;<span style="color:#C00000">logotypes</span>&quot;:&nbsp;</code>[<a href="#logotypes" style="margin-left:2pt;margin-right:2pt;">logotypes</a>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td><i>Optional:</i> List of logotype objects. See <code>SKS:addExtension</code>.</td></tr><tr><td colspan="4" style="background-color:white;border-width:0px;padding:10pt 0pt 0pt 0pt">Due to the stateful MAC-scheme featured in SKS, the properties beginning with <code>importSymmetricKey</code> and ending with <code>logotypes</code>, <b>must</b> <i>be generated (by the issuer) and executed (by the SKS) in exactly the order they are declared in this table as well as in associated object arrays</i>.<div style="height:6pt;padding:0px"></div>Note that that credential <code>id</code>s are not guaranteed to be supplied in the same order as during the associated <a href="#KeyCreationRequest">KeyCreationRequest</a>.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="cloneKeyProtection"><i>cloneKeyProtection</i></span>, &nbsp;<span id="deleteKeys"><i>deleteKeys</i></span>, &nbsp;<span id="unlockKeys"><i>unlockKeys</i></span>, &nbsp;<span id="updateKey"><i>updateKey</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="cloneKeyProtection.fingerPrint"><code>&quot;<span style="color:#C00000">fingerPrint</span>&quot;:&nbsp;</code><code>&quot;</code><i>fingerPrint</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">M</td><td>SHA256 fingerprint of target certificate.</td></tr><tr><td style="white-space:nowrap" id="cloneKeyProtection.serverSessionId"><code>&quot;<span style="color:#C00000">serverSessionId</span>&quot;:&nbsp;</code><code>&quot;</code><i>serverSessionId</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">M</td><td>For locating the target key.</td></tr><tr><td style="white-space:nowrap" id="cloneKeyProtection.clientSessionId"><code>&quot;<span style="color:#C00000">clientSessionId</span>&quot;:&nbsp;</code><code>&quot;</code><i>clientSessionId</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">M</td><td>For locating the target key.</td></tr><tr><td style="white-space:nowrap" id="cloneKeyProtection.authorization"><code>&quot;<span style="color:#C00000">authorization</span>&quot;:&nbsp;</code><code>&quot;</code><i>authorization</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">M</td><td>See &quot;Target Key Reference&quot; in the SKS reference.</td></tr><tr><td style="white-space:nowrap" id="cloneKeyProtection.mac"><code>&quot;<span style="color:#C00000">mac</span>&quot;:&nbsp;</code><code>&quot;</code><i>mac</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">M</td><td>Caller authentication. See <code>SKS:post* </code> methods<code>.mac</code>.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="encryptedExtensions"><i>encryptedExtensions</i></span>, &nbsp;<span id="extensions"><i>extensions</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="encryptedExtensions.type"><code>&quot;<span style="color:#C00000">type</span>&quot;:&nbsp;</code><code>&quot;</code><i>type</i><code>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">M</td><td>Extension type URI.</td></tr><tr><td style="white-space:nowrap" id="encryptedExtensions.extensionData"><code>&quot;<span style="color:#C00000">extensionData</span>&quot;:&nbsp;</code><code>&quot;</code><i>extensionData</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">M</td><td>Extension data.</td></tr><tr><td style="white-space:nowrap" id="encryptedExtensions.mac"><code>&quot;<span style="color:#C00000">mac</span>&quot;:&nbsp;</code><code>&quot;</code><i>mac</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">M</td><td>Caller authentication. See <code>SKS:addExtension.mac</code>.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="logotypes"><i>logotypes</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="logotypes.type"><code>&quot;<span style="color:#C00000">type</span>&quot;:&nbsp;</code><code>&quot;</code><i>type</i><code>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">M</td><td>Logotype type URI.</td></tr><tr><td style="white-space:nowrap" id="logotypes.mimeType"><code>&quot;<span style="color:#C00000">mimeType</span>&quot;:&nbsp;</code><code>&quot;</code><i>mimeType</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">M</td><td>Logotype MIME type.</td></tr><tr><td style="white-space:nowrap" id="logotypes.extensionData"><code>&quot;<span style="color:#C00000">extensionData</span>&quot;:&nbsp;</code><code>&quot;</code><i>extensionData</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">M</td><td>Logotype image data.</td></tr><tr><td style="white-space:nowrap" id="logotypes.mac"><code>&quot;<span style="color:#C00000">mac</span>&quot;:&nbsp;</code><code>&quot;</code><i>mac</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">M</td><td>Caller authentication. See <code>SKS:addExtension.mac</code>.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="propertyBags"><i>propertyBags</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="propertyBags.type"><code>&quot;<span style="color:#C00000">type</span>&quot;:&nbsp;</code><code>&quot;</code><i>type</i><code>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">M</td><td>Property bag type URI. See <code>SKS:addExtension</code>.</td></tr><tr><td style="white-space:nowrap" id="propertyBags.properties"><code>&quot;<span style="color:#C00000">properties</span>&quot;:&nbsp;</code>[<a href="#properties" style="margin-left:2pt;margin-right:2pt;">properties</a>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">object</td><td style="text-align:center">M</td><td>List of property values. See <code>SKS:addExtension</code>.</td></tr><tr><td style="white-space:nowrap" id="propertyBags.mac"><code>&quot;<span style="color:#C00000">mac</span>&quot;:&nbsp;</code><code>&quot;</code><i>mac</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">M</td><td>Caller authentication. See <code>SKS:addExtension.mac</code>.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="properties"><i>properties</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="properties.name"><code>&quot;<span style="color:#C00000">name</span>&quot;:&nbsp;</code><code>&quot;</code><i>name</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">M</td><td>Property name.</td></tr><tr><td style="white-space:nowrap" id="properties.value"><code>&quot;<span style="color:#C00000">value</span>&quot;:&nbsp;</code><code>&quot;</code><i>value</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">M</td><td>Property value.</td></tr><tr><td style="white-space:nowrap" id="properties.writable"><code>&quot;<span style="color:#C00000">writable</span>&quot;:&nbsp;</code><i>writable</i></td><td style="text-align:center">bool</td><td style="text-align:center">O</td><td>Writable flag. Default is <code>false</code>.  See <code>SKS:setProperty</code>.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="importPrivateKey"><i>importPrivateKey</i></span>, &nbsp;<span id="importSymmetricKey"><i>importSymmetricKey</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="importPrivateKey.encryptedKey"><code>&quot;<span style="color:#C00000">encryptedKey</span>&quot;:&nbsp;</code><code>&quot;</code><i>encryptedKey</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">M</td><td>Encrypted key material.  See <code>SKS:import* </code> methods<code>.encryptedKey</code>.</td></tr><tr><td style="white-space:nowrap" id="importPrivateKey.mac"><code>&quot;<span style="color:#C00000">mac</span>&quot;:&nbsp;</code><code>&quot;</code><i>mac</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">M</td><td>Caller authentication. See <code>SKS:import* </code>methods<code>.mac</code>.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="clientCapabilities"><i>clientCapabilities</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="clientCapabilities.type"><code>&quot;<span style="color:#C00000">type</span>&quot;:&nbsp;</code><code>&quot;</code><i>type</i><code>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">M</td><td>Client capability type URI.</td></tr><tr><td style="white-space:nowrap" id="clientCapabilities.supported"><code>&quot;<span style="color:#C00000">supported</span>&quot;:&nbsp;</code><code>&quot;</code><i>supported</i><code>&quot;</code></td><td style="text-align:center">bool</td><td style="text-align:center" rowspan="3">M</td><td>For non-parametric queries like algorithms this property tells if the type is supported or not. <div style="height:6pt;padding:0px"></div>Unknown or unsupported query types <b>must</b> always return this attribute with the argument <code>false</code>.</td></tr><tr><td style="white-space:nowrap" id="clientCapabilities.values"><code>&quot;<span style="color:#C00000">values</span>&quot;:&nbsp;</code>[<code>&quot;</code><i>values</i><code>&quot;</code>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">string</td><td>List of attribute data associated with <code>type</code>.</td></tr><tr><td style="white-space:nowrap" id="clientCapabilities.imageAttributes"><code>&quot;<span style="color:#C00000">imageAttributes</span>&quot;:&nbsp;</code><a href="#imageAttributes">imageAttributes</a></td><td style="text-align:center">object</td><td>List of client image preferences that the issuer may use for creating suitable <a href="#logotypes">logotypes</a>.  Known logotypes include:<ul><li><code>http://xmlns.webpki.org/keygen2/logotype#list</code><br>This type is meant to be used in credential lists and management dialogs where you could use a logotype together with a &quot;friendly name&quot; string or similar.</li><li style="padding-top:4pt"><code>http://xmlns.webpki.org/keygen2/logotype#card</code><br>A shape designed for wallet-like applications where logotypes usually are personalized.</li><li style="padding-top:4pt"><code>http://xmlns.webpki.org/keygen2/logotype#icon</code><br>Intended for selection windows holding large collections of credentials featured as maps or lists of <i>small</i> icons.</li><li style="padding-top:4pt"><code>http://xmlns.webpki.org/keygen2/logotype#application</code><br>Could be used in applications where a logotype is useful for branding/recognition purposes like in OTP systems.</li></ul>Logotypes should not have framing borders or extra margins unless these are integral parts of the actual logotype image. Logotypes should render nicely on light backgrounds. Shadows should be avoided since the icon viewer itself may add such. Support for PNG files is <i>mandatory</i>.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="imageAttributes"><i>imageAttributes</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="imageAttributes.mimeType"><code>&quot;<span style="color:#C00000">mimeType</span>&quot;:&nbsp;</code><code>&quot;</code><i>mimeType</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">M</td><td>Image MIME type.</td></tr><tr><td style="white-space:nowrap" id="imageAttributes.width"><code>&quot;<span style="color:#C00000">width</span>&quot;:&nbsp;</code><code>&quot;</code><i>width</i><code>&quot;</code></td><td style="text-align:center">uint</td><td style="text-align:center">M</td><td>Image width.</td></tr><tr><td style="white-space:nowrap" id="imageAttributes.height"><code>&quot;<span style="color:#C00000">height</span>&quot;:&nbsp;</code><code>&quot;</code><i>height</i><code>&quot;</code></td><td style="text-align:center">uint</td><td style="text-align:center">M</td><td>Image height.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="deviceId"><i>deviceId</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="deviceId.certificatePath"><code>&quot;<span style="color:#C00000">certificatePath</span>&quot;:&nbsp;</code>[<code>&quot;</code><i>Sorted Certificate Path</i><code>&quot;</code>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">base64</td><td style="text-align:center">M</td><td>Identical representation as the <code>certificatePath</code> in <a href="#signature">signature</a>.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="serverEphemeralKey"><i>serverEphemeralKey</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="serverEphemeralKey.publicKey"><code>&quot;<span style="color:#C00000">publicKey</span>&quot;:&nbsp;</code><a href="#publicKey">publicKey</a></td><td style="text-align:center">object</td><td style="text-align:center">M</td><td><code>serverEphemeralKey</code> <b>must</b> be an EC key matching the capabilities of the SKS.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="clientEphemeralKey"><i>clientEphemeralKey</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="clientEphemeralKey.publicKey"><code>&quot;<span style="color:#C00000">publicKey</span>&quot;:&nbsp;</code><a href="#publicKey">publicKey</a></td><td style="text-align:center">object</td><td style="text-align:center">M</td><td><code>clientEphemeralKey</code> <b>must</b> be an EC key using the same curve as <code>serverEphemeralKey</code>.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="signature"><i>signature</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="signature.version"><code>&quot;<span style="color:#C00000">version</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">http://xmlns.webpki.org/jcs/v1</span>&quot;</code></td><td style="text-align:center">uri</td><td style="text-align:center">O</td><td><a href="#Reference.JCS">[JCS]</a> option: Signature object version identifier.</td></tr><tr><td style="white-space:nowrap" id="signature.algorithm"><code>&quot;<span style="color:#C00000">algorithm</span>&quot;:&nbsp;</code><code>&quot;</code><i>algorithm</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">M</td><td><a href="#Reference.JCS">[JCS]</a>: Signature algorithm ID. See SKS &quot;Algorithm Support&quot;.<div style="height:6pt;padding:0px"></div>The currently recognized symmetric key algorithms include:<ul><li><code>http://www.w3.org/2000/09/xmldsig#hmac-sha1</code></li><li><code>http://www.w3.org/2001/04/xmldsig-more#hmac-sha256</code></li><li><code>http://www.w3.org/2001/04/xmldsig-more#hmac-sha384</code></li><li><code>http://www.w3.org/2001/04/xmldsig-more#hmac-sha512</code></li></ul>The currently recognized asymmetric key algorithms include:<ul><li><code>http://www.w3.org/2000/09/xmldsig#rsa-sha1</code></li><li><code>http://www.w3.org/2001/04/xmldsig-more#rsa-sha256</code></li><li><code>http://www.w3.org/2001/04/xmldsig-more#rsa-sha384</code></li><li><code>http://www.w3.org/2001/04/xmldsig-more#rsa-sha512</code></li><li><code>http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha256</code></li><li><code>http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha384</code></li><li><code>http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha512</code></li></ul></td></tr><tr><td style="white-space:nowrap" id="signature.publicKey"><code>&quot;<span style="color:#C00000">publicKey</span>&quot;:&nbsp;</code><a href="#publicKey">publicKey</a></td><td style="text-align:center">object</td><td style="text-align:center" rowspan="2">O</td><td><a href="#Reference.JCS">[JCS]</a> option: Public key object.</td></tr><tr><td style="white-space:nowrap" id="signature.certificatePath"><code>&quot;<span style="color:#C00000">certificatePath</span>&quot;:&nbsp;</code>[<code>&quot;</code><i>Sorted Certificate Path</i><code>&quot;</code>]<span style="position:relative;bottom:-0.5em;font-size:.9em">&thinsp;1-n</span></td><td style="text-align:center">base64</td><td><a href="#Reference.JCS">[JCS]</a> option: Sorted array of X.509 <a href="#Reference.RFC5280">[RFC5280]</a> certificates, where the <i>first</i> element <b>must</b> contain the <i style="white-space:nowrap">signature certificate</i>. The certificate path <b>must</b> be <i>contiguous</i> but is not required to be complete.</td></tr><tr><td style="white-space:nowrap" id="signature.signerCertificate"><code>&quot;<span style="color:#C00000">signerCertificate</span>&quot;:&nbsp;</code><a href="#signerCertificate">signerCertificate</a></td><td style="text-align:center">object</td><td style="text-align:center">O</td><td><a href="#Reference.JCS">[JCS]</a> option: Signature certificate attribute data for usage with the <code>certificatePath</code> option.<div style="height:6pt;padding:0px"></div>A compliant JCS implementation <b>must</b> verify that the <code>signerCertificate</code> object matches the first certificate in the <code>certificatePath</code>.<div style="height:6pt;padding:0px"></div>Note: due to the fact that X.500 name comparisons have turned out (in practice) to be a source of non-interoperability, the <code>signerCertificate</code> option <i>should only be used in specific environments</i>.</td></tr><tr><td style="white-space:nowrap" id="signature.value"><code>&quot;<span style="color:#C00000">value</span>&quot;:&nbsp;</code><code>&quot;</code><i>value</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">M</td><td><a href="#Reference.JCS">[JCS]</a>: The signature data.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="publicKey"><i>publicKey</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="publicKey.type"><code>&quot;<span style="color:#C00000">type</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">EC</span>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center" rowspan="2">M</td><td><a href="#Reference.JCS">[JCS]</a>: EC key type indicator.  For the additional properties see: <a href="#publicKey_EC">publicKey&nbsp;EC</a></td></tr><tr><td style="white-space:nowrap" id="publicKey.type"><code>&quot;<span style="color:#C00000">type</span>&quot;:&nbsp;</code><code>&quot;<span style="color:#0000C0">RSA</span>&quot;</code></td><td style="text-align:center">string</td><td><a href="#Reference.JCS">[JCS]</a>: RSA key type indicator. For the additional properties see: <a href="#publicKey_RSA">publicKey&nbsp;RSA</a></td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="publicKey_EC"><i>publicKey EC</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="publicKey_EC.curve"><code>&quot;<span style="color:#C00000">curve</span>&quot;:&nbsp;</code><code>&quot;</code><i>curve</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">M</td><td><a href="#Reference.JCS">[JCS]</a>: EC curve ID. See SKS &quot;Algorithm Support&quot;.<div style="height:6pt;padding:0px"></div>The currently recognized EC curves include:<ul><li><code>http://xmlns.webpki.org/sks/algorithm#ec.nist.b163</code></li><li><code>http://xmlns.webpki.org/sks/algorithm#ec.nist.b233</code></li><li><code>http://xmlns.webpki.org/sks/algorithm#ec.nist.b283</code></li><li><code>http://xmlns.webpki.org/sks/algorithm#ec.nist.p192</code></li><li><code>http://xmlns.webpki.org/sks/algorithm#ec.nist.p256</code></li><li><code>http://xmlns.webpki.org/sks/algorithm#ec.nist.p384</code></li><li><code>http://xmlns.webpki.org/sks/algorithm#ec.nist.p521</code></li><li><code>http://xmlns.webpki.org/sks/algorithm#ec.secg.p256k1</code></li><li><code>http://xmlns.webpki.org/sks/algorithm#ec.brainpool.p256r1</code></li></ul></td></tr><tr><td style="white-space:nowrap" id="publicKey_EC.x"><code>&quot;<span style="color:#C00000">x</span>&quot;:&nbsp;</code><code>&quot;</code><i>x</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">M</td><td><a href="#Reference.JCS">[JCS]</a>: EC curve point X. The length of this field <b>must</b> be the full size of a coordinate for the curve specified in the <code>curve</code> parameter.  For example, if the value of <code>curve</code> is <code>http://xmlns.webpki.org/sks/algorithm#ec.nist.p521</code>, the <i>decoded</i> argument <b>must</b> be 66 bytes</td></tr><tr><td style="white-space:nowrap" id="publicKey_EC.y"><code>&quot;<span style="color:#C00000">y</span>&quot;:&nbsp;</code><code>&quot;</code><i>y</i><code>&quot;</code></td><td style="text-align:center">base64</td><td style="text-align:center">M</td><td><a href="#Reference.JCS">[JCS]</a>: EC curve point Y. The length of this field <b>must</b> be the full size of a coordinate for the curve specified in the <code>curve</code> parameter.  For example, if the value of <code>curve</code> is <code>http://xmlns.webpki.org/sks/algorithm#ec.nist.p521</code>, the <i>decoded</i> argument <b>must</b> be 66 bytes.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="publicKey_RSA"><i>publicKey RSA</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="publicKey_RSA.n"><code>&quot;<span style="color:#C00000">n</span>&quot;:&nbsp;</code><code>&quot;</code><i>n</i><code>&quot;</code></td><td style="text-align:center">crypto</td><td style="text-align:center">M</td><td><a href="#Reference.JCS">[JCS]</a>: RSA modulus. Also see the <a href="#Datatype.crypto">crypto</a> data type.</td></tr><tr><td style="white-space:nowrap" id="publicKey_RSA.e"><code>&quot;<span style="color:#C00000">e</span>&quot;:&nbsp;</code><code>&quot;</code><i>e</i><code>&quot;</code></td><td style="text-align:center">crypto</td><td style="text-align:center">M</td><td><a href="#Reference.JCS">[JCS]</a>: RSA exponent. Also see the <a href="#Datatype.crypto">crypto</a> data type.</td></tr><tr><td colspan="4" style="border-width:0px;font-size:14pt;padding:20pt 0pt 10pt 0pt;font-family:arial,verdana,helvetica;background-color:white"><span id="signerCertificate"><i>signerCertificate</i></span></td></tr>
<tr><th>Property</th><th>Type</th><th>Req</th><th>Comment</th></tr><tr><td style="white-space:nowrap" id="signerCertificate.issuer"><code>&quot;<span style="color:#C00000">issuer</span>&quot;:&nbsp;</code><code>&quot;</code><i>issuer</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">M</td><td><a href="#Reference.JCS">[JCS]</a>: Issuer distinguished name in LDAP <a href="#Reference.RFC4514">[RFC4514]</a> notation.</td></tr><tr><td style="white-space:nowrap" id="signerCertificate.serialNumber"><code>&quot;<span style="color:#C00000">serialNumber</span>&quot;:&nbsp;</code><code>&quot;</code><i>serialNumber</i><code>&quot;</code></td><td style="text-align:center">bigint</td><td style="text-align:center">M</td><td><a href="#Reference.JCS">[JCS]</a>: Certificate serial number.</td></tr><tr><td style="white-space:nowrap" id="signerCertificate.subject"><code>&quot;<span style="color:#C00000">subject</span>&quot;:&nbsp;</code><code>&quot;</code><i>subject</i><code>&quot;</code></td><td style="text-align:center">string</td><td style="text-align:center">M</td><td><a href="#Reference.JCS">[JCS]</a>: Subject distinguished name in LDAP <a href="#Reference.RFC4514">[RFC4514]</a> notation.</td></tr></table><div style="width:1000pt"><div style="padding:10pt 0pt 10pt 0pt" id="Sample_Run"><span style="font-size:14pt">Appendix A:&nbsp;Sample Run</span></div>In the following KeyGen2 sample run the issuer requests that the client (SKS) creates an RSA 2048-bit key protected by a user-set PIN governed by a number of issuer-defined policies.<div style="height:6pt;padding:0px"></div>Finally, the issuer provides a certificate and a platform-adapted logotype.<div style="height:6pt;padding:0px"></div>For information regarding the cryptographic constructs, consult the SKS architecture manual.<table class="tftable" style="margin-top:10pt"><tr><th id="Sample.InvocationRequest">InvocationRequest</th></tr><tr><td><code>{<br>&nbsp;&nbsp;&quot;<span style="color:#606060">@context</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">http://xmlns.webpki.org/keygen2/beta/20150112</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#606060">@qualifier</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">InvocationRequest</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">serverSessionId</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">142f1bdb286XVQnqmIRc1bSzm-QN-ZJk</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">submitUrl</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">https://issuer.example.com/invocation</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">action</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">manage</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">clientCapabilityQuery</span>&quot;:&nbsp;[&quot;<span style="color:#0000C0">http://xmlns.webpki.org/keygen2/logotype#list</span>&quot;]<br>}</code></td></tr><tr><td style="background-color:white;border-width:0px;padding:10pt 0pt 10pt 0pt">After a <i>compatible</i> browser has received this message, a dialog like the following is shown to user:<table class="dlgtbl"><tr><td colspan="2" style="text-align:center;font-size:14pt;font-family:arial,verdana,helvetica;background-color:lightblue;border-width:0pt 0pt 1pt 0pt">Credential Enrollment</td></tr><tr><td colspan="2">The following provider wants to create a<br>login credential for you:</td></tr><tr><td colspan="2" style="text-align:center;padding-bottom:15pt"><div style="display:inline-block" class="dlgtext">issuer.example.com</div></td></tr><tr><td><div class="dlgbtn">Cancel</div></td><td style="text-align:right"><div class="dlgbtn">&nbsp;&nbsp;OK&nbsp;&nbsp;</div></td></tr></table>If the user accepts the request, the following response is sent to the server at the address specified by <a href="#InvocationRequest.submitUrl">submitUrl</a>:</td></tr><tr><th id="Sample.InvocationResponse">InvocationResponse</th></tr><tr><td><code>{<br>&nbsp;&nbsp;&quot;<span style="color:#606060">@context</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">http://xmlns.webpki.org/keygen2/beta/20150112</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#606060">@qualifier</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">InvocationResponse</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">serverSessionId</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">142f1bdb286XVQnqmIRc1bSzm-QN-ZJk</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">clientCapabilities</span>&quot;:&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;[{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">type</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">http://xmlns.webpki.org/keygen2/logotype#list</span>&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">imageAttributes</span>&quot;:&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">mimeType</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">image/png</span>&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">width</span>&quot;:&nbsp;<span style="color:#008000">94</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">height</span>&quot;:&nbsp;<span style="color:#008000">74</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}]<br>}</code></td></tr><tr><td style="background-color:white;border-width:0px;padding:10pt 0pt 10pt 0pt">When the server has received the response above, it creates an <i>ephemeral EC key-pair</i> and returns the public part to the client<br>together with other session parameters:</td></tr><tr><th id="Sample.ProvisioningInitializationRequest">ProvisioningInitializationRequest</th></tr><tr><td><code>{<br>&nbsp;&nbsp;&quot;<span style="color:#606060">@context</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">http://xmlns.webpki.org/keygen2/beta/20150112</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#606060">@qualifier</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">ProvisioningInitializationRequest</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">serverSessionId</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">142f1bdb286XVQnqmIRc1bSzm-QN-ZJk</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">submitUrl</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">https://issuer.example.com/provsess</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">serverTime</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">2015-05-22T16:33:30Z</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">sessionKeyAlgorithm</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">http://xmlns.webpki.org/sks/algorithm#session.1</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">sessionKeyLimit</span>&quot;:&nbsp;<span style="color:#008000">20</span>,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">sessionLifeTime</span>&quot;:&nbsp;<span style="color:#008000">300</span>,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">serverEphemeralKey</span>&quot;:&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">publicKey</span>&quot;:&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">type</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">EC</span>&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">curve</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">http://xmlns.webpki.org/sks/algorithm#ec.nist.p256</span>&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">x</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">cpxUxJVt-is8bgWRFm6RuvUkxyv7xJ7PbeT1BCQNNws</span>&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">y</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">De7jXYsdL46ikHOWeC-V-AcNM/RURpu6ZgcVAxLUwns</span>&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>}</code></td></tr><tr><td style="background-color:white;border-width:0px;padding:10pt 0pt 10pt 0pt">Next the client generates a <i>matching ephemeral EC key-pair</i> and sends the public part back to the server including a client<br>session-ID, key-attestation, device-certificate, etc.:</td></tr><tr><th id="Sample.ProvisioningInitializationResponse">ProvisioningInitializationResponse</th></tr><tr><td><code>{<br>&nbsp;&nbsp;&quot;<span style="color:#606060">@context</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">http://xmlns.webpki.org/keygen2/beta/20150112</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#606060">@qualifier</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">ProvisioningInitializationResponse</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">serverSessionId</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">142f1bdb286XVQnqmIRc1bSzm-QN-ZJk</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">clientSessionId</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">39NMWamKtHumJFfdIGkDrLP-NMB-5Lwo</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">serverTime</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">2015-05-22T16:33:30Z</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">clientTime</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">2015-05-22T18:33:36+02:00</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">clientEphemeralKey</span>&quot;:&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">publicKey</span>&quot;:&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">type</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">EC</span>&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">curve</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">http://xmlns.webpki.org/sks/algorithm#ec.nist.p256</span>&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">x</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">tQXczn7qxGgcLpOVBuw5i-tMHxbJTUF6k3RZGsjdauc</span>&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">y</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">jIlm8sXwknZeQQDTxkfwXKUdhubt6JcqQYA6S8Dm3AE</span>&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;},<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">deviceId</span>&quot;:&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">certificatePath</span>&quot;:&nbsp;[&quot;<span style="color:#0000C0">MIIC2DCCAcCgAwIBAgIGARTWcc7VMCSq....awCV4OfAGXLIwJBCp85AN7KNdcJfL</span>&quot;]<br>&nbsp;&nbsp;&nbsp;&nbsp;},<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">attestation</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">KMUpOesC8nDTLpu8PppsSGg1j....WiwvUcVpbNudbY14lLks8RQuwoiU</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">serverCertificateFingerPrint</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">HwKCofkqkTFXRmyyb_CnWhAcTbQF7w8rl1OqCwyM4TM</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">signature</span>&quot;:&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">algorithm</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">http://www.w3.org/2001/04/xmldsig-more#hmac-sha256</span>&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">value</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">nnzNSZUZw1qlGVydZZ3ssCVIZTznyHwDXlOpLMpI3Lo</span>&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;}<br>}</code></td></tr><tr><td style="background-color:white;border-width:0px;padding:10pt 0pt 10pt 0pt">After these message exchanges, the SKS and server (issuer) have established a <i>shared session-key</i>, which is used for securing the<br>rest of the session through MAC- and encryption-operations.<br>&nbsp;<br>SKS API Reference: <code>createProvisioningSession</code>.<br>&nbsp;<br>In the sample a request for creating a key is subsequently returned to the client:</td></tr><tr><th id="Sample.KeyCreationRequest">KeyCreationRequest</th></tr><tr><td><code>{<br>&nbsp;&nbsp;&quot;<span style="color:#606060">@context</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">http://xmlns.webpki.org/keygen2/beta/20150112</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#606060">@qualifier</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">KeyCreationRequest</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">serverSessionId</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">142f1bdb286XVQnqmIRc1bSzm-QN-ZJk</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">clientSessionId</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">39NMWamKtHumJFfdIGkDrLP-NMB-5Lwo</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">submitUrl</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">https://issuer.example.com/keyinit</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">keyEntryAlgorithm</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">http://xmlns.webpki.org/sks/algorithm#key.1</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">pinPolicySpecifiers</span>&quot;:&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;[{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">id</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">PIN.1</span>&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">minLength</span>&quot;:&nbsp;<span style="color:#008000">4</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">maxLength</span>&quot;:&nbsp;<span style="color:#008000">8</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">retryLimit</span>&quot;:&nbsp;<span style="color:#008000">3</span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">format</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">numeric</span>&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">patternRestrictions</span>&quot;:&nbsp;[&quot;<span style="color:#0000C0">three-in-a-row</span>&quot;,&quot;<span style="color:#0000C0">sequence</span>&quot;],<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">mac</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">2aUMRubbEk8Xs62QXlPiFJbYlJ68Sw4Fhu48j4uGKXk</span>&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">keyEntrySpecifiers</span>&quot;:&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">id</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">Key.1</span>&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">appUsage</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">authentication</span>&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">keyAlgorithm</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">http://xmlns.webpki.org/sks/algorithm#rsa2048</span>&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">mac</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">BQpWMwSz4EsYgliHH6RY3UNWuLsR3eJVapY0CYOUTtI</span>&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}]<br>}</code></td></tr><tr><td style="background-color:white;border-width:0px;padding:10pt 0pt 10pt 0pt">After the browser has received this message, a dialog like the following is shown to user:<table class="dlgtbl"><tr><td colspan="2" style="text-align:center;font-size:14pt;font-family:arial,verdana,helvetica;background-color:lightblue;border-width:0pt 0pt 1pt 0pt">PIN Code Assignment</td></tr><tr><td colspan="2">Set and memorize a PIN for the<br>login credential:</td></tr><tr><td colspan="2" style="padding-top:0px"><div class="dlgtext">&#x2022; &#x2022; &#x2022; &#x2022; &#x2022; &#x2022;</div></td></tr><tr><td colspan="2">Repeat PIN:</td></tr><tr><td colspan="2" style="padding-top:0px;padding-bottom:15pt"><div class="dlgtext">&#x2022; &#x2022; &#x2022; &#x2022; &#x2022; &#x2022;</div></td></tr><tr><td><div class="dlgbtn">Cancel</div></td><td style="text-align:right"><div class="dlgbtn">&nbsp;&nbsp;OK&nbsp;&nbsp;</div></td></tr></table>When the user has set a PIN <i>matching the issuer's policy</i> and hit &quot;OK&quot;, the requested key-pair is created and the public part of the<br>key-pair is sent to the server for certification as shown in the response below.<br>&nbsp;<br>SKS API References: <code>createPinPolicy</code>, <code>createKeyEntry</code>.</td></tr><tr><th id="Sample.KeyCreationResponse">KeyCreationResponse</th></tr><tr><td><code>{<br>&nbsp;&nbsp;&quot;<span style="color:#606060">@context</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">http://xmlns.webpki.org/keygen2/beta/20150112</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#606060">@qualifier</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">KeyCreationResponse</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">serverSessionId</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">142f1bdb286XVQnqmIRc1bSzm-QN-ZJk</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">clientSessionId</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">39NMWamKtHumJFfdIGkDrLP-NMB-5Lwo</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">generatedKeys</span>&quot;:&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;[{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">id</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">Key.1</span>&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">publicKey</span>&quot;:&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">type</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">RSA</span>&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">n</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">uSW5wpfano32Q6oU3xMkFig0r145DN....jkjy1ENPdBQaafvJnuh4x58WPTsVCvjimw</span>&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">e</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">AQAB</span>&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">attestation</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">gyRmTPdW4UdGdXlLkHf40PPRL9xac31eJnyyBtf7-Io</span>&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}]<br>}</code></td></tr><tr><td style="background-color:white;border-width:0px;padding:10pt 0pt 10pt 0pt">The server responds by issuing a matching certificate including an associated logotype.<br>&nbsp;<br>SKS API References: <code>setCertificatePath</code>, <code>addExtension</code>.</td></tr><tr><th id="Sample.ProvisioningFinalizationRequest">ProvisioningFinalizationRequest</th></tr><tr><td><code>{<br>&nbsp;&nbsp;&quot;<span style="color:#606060">@context</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">http://xmlns.webpki.org/keygen2/beta/20150112</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#606060">@qualifier</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">ProvisioningFinalizationRequest</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">serverSessionId</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">142f1bdb286XVQnqmIRc1bSzm-QN-ZJk</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">clientSessionId</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">39NMWamKtHumJFfdIGkDrLP-NMB-5Lwo</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">submitUrl</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">https://issuer.example.com/finalize</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">issuedCredentials</span>&quot;:&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;[{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">id</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">Key.1</span>&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">certificatePath</span>&quot;:&nbsp;[&quot;<span style="color:#0000C0">MIICmDCCAYCgAwIBAgIGAULxF0G....UimDl7Dt7733M0TT8qSpXeYvV0NLX5kM</span>&quot;],<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">mac</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">FkwauPbrrfJZxuEsMkwOFWIIutzdYbEt3P9kr0CG4dc</span>&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">logotypes</span>&quot;:&nbsp;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">type</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">http://xmlns.webpki.org/keygen2/logotype#list</span>&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">mimeType</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">image/png</span>&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">extensionData</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">RBgoJkiaJk_IsZAEZUBsZAEZFg....NVBAMTC0RlbW8gU3ViIENBMBTEzMM1oDTM4</span>&quot;,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;<span style="color:#C00000">mac</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">uQ5IuLRDpbSkpfU9FHe1grrQ_FXUBfsxsk6HqspjuCU</span>&quot;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}]<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}],<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">nonce</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">_U9YmqyULox2Q53F4l9pQaxjbzlOu2wMo6_FgGAmooQ</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">mac</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">_e0T_svX9vXQTuyIxDUmmteM2IwvXbSOEREuqbe7fS4</span>&quot;<br>}</code></td></tr><tr><td style="background-color:white;border-width:0px;padding:10pt 0pt 10pt 0pt">The finalization message which will only be sent to the server if the previous steps were successful.<br>&nbsp;<br>SKS API Reference: <code>closeProvisioningSession</code>.</td></tr><tr><th id="Sample.ProvisioningFinalizationResponse">ProvisioningFinalizationResponse</th></tr><tr><td><code>{<br>&nbsp;&nbsp;&quot;<span style="color:#606060">@context</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">http://xmlns.webpki.org/keygen2/beta/20150112</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#606060">@qualifier</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">ProvisioningFinalizationResponse</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">serverSessionId</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">142f1bdb286XVQnqmIRc1bSzm-QN-ZJk</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">clientSessionId</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">39NMWamKtHumJFfdIGkDrLP-NMB-5Lwo</span>&quot;,<br>&nbsp;&nbsp;&quot;<span style="color:#C00000">attestation</span>&quot;:&nbsp;&quot;<span style="color:#0000C0">Oy8QaNN0orkE2gxlCWrMYHxDNr6m5FTdVpqTqF9eXlI</span>&quot;<br>}</code></td></tr><tr><td style="background-color:white;border-width:0px;padding:10pt 0pt 10pt 0pt">Here the user is supposed to receive an issuer-specific web-page telling what to do next. See <a href="#Termination_Message">Termination&nbsp;Message</a>.</td></tr></table></div><div style="width:1000pt"><div style="padding:10pt 0pt 10pt 0pt" id="Acknowledgements"><span style="font-size:14pt">Appendix B:&nbsp;Acknowledgements</span></div>The design of the KeyGen2 protocol was &quot;inspired&quot; by several predecessors, most notably IETF's DSKPP <a href="#Reference.RFC6063">[RFC6063]</a>.<div style="height:6pt;padding:0px"></div>Funding has been provided by <i>PrimeKey Solutions AB</i> and the <i>Swedish Innovation Board (VINNOVA)</i>.</div><div style="width:1000pt"><div style="padding:10pt 0pt 10pt 0pt" id="References"><span style="font-size:14pt">Appendix C:&nbsp;References</span></div></div><table class="tftable" style="width:600pt"><tr><th>Reference</th><th>Description</th></tr><tr><td id="Reference.JCS" style="white-space:nowrap">[JCS]</td><td>A. Rundgren, "JCS - JSON Cleartext Signature", Work in progress,<br><a target="_blank" title="External link opened in a new window" href="https://cyberphone.github.io/openkeystore/resources/docs/jcs.html"><span style="white-space: nowrap">https://cyberphone.github.io/openkeystore/resources/docs/jcs.html</span></a>, <span style="white-space: nowrap">V0.58, January&nbsp;2015.</span></td></tr><tr><td id="Reference.JOSE" style="white-space:nowrap">[JOSE]</td><td>M. Jones, et al, Work in progress, <a target="_blank" title="External link opened in a new window" href="https://ietf.org/wg/jose/"><span style="white-space: nowrap">https://ietf.org/wg/jose/</span></a>, <span style="white-space: nowrap">January&nbsp;2015.</span></td></tr><tr><td id="Reference.RFC3986" style="white-space:nowrap">[RFC3986]</td><td>T. Berners-Lee, R. Fielding, L. Masinter, "Uniform Resource Identifier (URI): Generic Syntax", RFC&nbsp;3986, January&nbsp;2005.</td></tr><tr><td id="Reference.RFC4210" style="white-space:nowrap">[RFC4210]</td><td>C. Adams, S. Farrell, T. Kause, T. Mononen, "Internet X.509 Public Key Infrastructure Certificate Management Protocol (CMP)", RFC&nbsp;4210, September&nbsp;2005.</td></tr><tr><td id="Reference.RFC4514" style="white-space:nowrap">[RFC4514]</td><td>K. Zeilenga, "Lightweight Directory Access Protocol (LDAP): String Representation of Distinguished Names", RFC&nbsp;4514, June&nbsp;2006.</td></tr><tr><td id="Reference.RFC4648" style="white-space:nowrap">[RFC4648]</td><td>S. Josefsson, "The Base16, Base32, and Base64 Data Encodings", RFC&nbsp;4648, October&nbsp;2006.</td></tr><tr><td id="Reference.RFC5208" style="white-space:nowrap">[RFC5208]</td><td>B. Kaliski, "Public-Key Cryptography Standards (PKCS) #8: Private-Key Information Syntax Specification Version 1.2", RFC&nbsp;5208, May&nbsp;2008.</td></tr><tr><td id="Reference.RFC5280" style="white-space:nowrap">[RFC5280]</td><td>D. Cooper, S. Santesson, S. Farrell, S. Boeyen, R. Housley, W. Polk, "Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile", RFC&nbsp;5280, May&nbsp;2008.</td></tr><tr><td id="Reference.RFC6063" style="white-space:nowrap">[RFC6063]</td><td>A. Doherty, M. Pei, S. Machani, M. Nystrom, "Dynamic Symmetric Key Provisioning Protocol (DSKPP)", RFC&nbsp;6063, December&nbsp;2010.</td></tr><tr><td id="Reference.RFC7159" style="white-space:nowrap">[RFC7159]</td><td>T. Bray, "The JavaScript Object Notation (JSON) Data Interchange Format", RFC&nbsp;7159, March&nbsp;2014.</td></tr><tr><td id="Reference.SKS" style="white-space:nowrap">[SKS]</td><td>A. Rundgren, "Secure Key Store (SKS) - API and Architecture", Work in progress, <a target="_blank" title="External link opened in a new window" href="https://cyberphone.github.io/openkeystore/resources/docs/sks-api-arch.pdf"><span style="white-space: nowrap">https://cyberphone.github.io/openkeystore/resources/docs/sks-api-arch.pdf</span></a>, <span style="white-space: nowrap">V0.99, January&nbsp;2015.</span></td></tr><tr><td id="Reference.WEBIDL" style="white-space:nowrap">[WEBIDL]</td><td>C. McCormack, "Web IDL", W3C Candidate Recommendation, April&nbsp;2012. <br><a target="_blank" title="External link opened in a new window" href="http://www.w3.org/TR/2012/CR-WebIDL-20120419/"><span style="white-space: nowrap">http://www.w3.org/TR/2012/CR-WebIDL-20120419/</span></a></td></tr><tr><td id="Reference.XMLDSIG" style="white-space:nowrap">[XMLDSIG]</td><td>D. Eastlake, J. Reagle, D. Solo, F. Hirsch, M. Nystrom, T. Roessler, K. Yiu, "XML Signature Syntax and Processing Version 1.1.", W3C Recommendation, April&nbsp;2013. <br><a target="_blank" title="External link opened in a new window" href="http://www.w3.org/TR/2013/REC-xmldsig-core1-20130411/"><span style="white-space: nowrap">http://www.w3.org/TR/2013/REC-xmldsig-core1-20130411/</span></a></td></tr></table><div style="width:1000pt"><div style="padding:10pt 0pt 10pt 0pt" id="Document_History"><span style="font-size:14pt">Appendix D:&nbsp;Document History</span></div><table class="tftable"><tr><th>Date</th><th>Ver</th><th>Comment</th></tr><tr><td>2014-08-08</td><td style="text-align:center">0.7</td><td>First official release</td></tr><tr><td>2014-12-08</td><td style="text-align:center">0.71</td><td>Aligned KeyGen2 with the updated <a href="#Reference.SKS">[SKS]</a> and <a href="#Reference.JCS">[JCS]</a> specifications</td></tr><tr><td>2015-01-12</td><td style="text-align:center">0.72</td><td>Updated version to match ECDSA signature encoding change</td></tr></table></div><div style="width:1000pt"><div style="padding:10pt 0pt 10pt 0pt" id="Author"><span style="font-size:14pt">Appendix E:&nbsp;Author</span></div>KeyGen2 was primarily developed by Anders Rundgren (<code>anders.rundgren.net@gmail.com</code>).</div></body></html>